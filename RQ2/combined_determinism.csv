type,query,func_name,plantime,estcost,exectime,cost ratio,time ratio,
" derived from procbench, udf in predicate, big difference using result cache",EXPLAIN ANALYZE SELECT * from item where sudf_8_maxretclass() is not null and i_class = sudf_8_maxretclass(),sudf_8_maxretclass,0,0,120000,1,1,0
" derived from procbench, udf in predicate, big difference using result cache",EXPLAIN ANALYZE  SELECT * from item where sudf_8_maxretclass_cache() is not null and i_class = sudf_8_maxretclass_cache(),sudf_8_maxretclass_cache,0.835,12961,1199.352667,0,100.0539736,1
" derived from q67, udf in predicate, big difference using result cache","EXPLAIN ANALYZE select from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 and sudf_8_maxretclass() is not null and i_class = sudf_8_maxretclass() order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100",sudf_8_maxretclass,0,0,120000,1,1,0
" derived from q67, udf in predicate, big difference using result cache","EXPLAIN ANALYZE  select from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 and sudf_8_maxretclass_cache() is not null and i_class = sudf_8_maxretclass_cache() order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100",sudf_8_maxretclass_cache,2.307,139587.14,17961.98533,0,6.680775971,1
" derived from q45, udf in subquery predicate with null check,big difference using result cache","EXPLAIN ANALYZE SELECT ca_zip, ca_state, Sum(ws_sales_price) FROM   web_sales, customer, customer_address, date_dim, item WHERE  ws_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792' ) OR i_item_id IN (SELECT i_item_id FROM   item WHERE  i_item_sk IN ( 2, 3, 5, 7, 11, 13, 17, 19, 23, 29 ) AND sudf_8_maxretclass() is not null and i_class = sudf_8_maxretclass()) ) AND ws_sold_date_sk = d_date_sk AND d_qoy = 1 AND d_year = 2000 GROUP  BY ca_zip, ca_state ORDER  BY ca_zip, ca_state LIMIT 100",sudf_8_maxretclass,3.413,34410.19,4355.465667,1,1,0
" derived from q45, udf in subquery predicate with null check,big difference using result cache","EXPLAIN ANALYZE  SELECT ca_zip, ca_state, Sum(ws_sales_price) FROM   web_sales, customer, customer_address, date_dim, item WHERE  ws_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792' ) OR i_item_id IN (SELECT i_item_id FROM   item WHERE  i_item_sk IN ( 2, 3, 5, 7, 11, 13, 17, 19, 23, 29 ) AND sudf_8_maxretclass_cache() is not null and i_class = sudf_8_maxretclass_cache()) ) AND ws_sold_date_sk = d_date_sk AND d_qoy = 1 AND d_year = 2000 GROUP  BY ca_zip, ca_state ORDER  BY ca_zip, ca_state LIMIT 100",sudf_8_maxretclass_cache,3.167,34410.19,1415.629333,1,3.076699221,1
" derived from q92, udf in predicate, improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_nmonthsbefore(d_Date_string, 3) between '2000-05-04' and '2030-10-05' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    sudf_nmonthsbefore(d_Date_string, 3) between '1981-08-09' and '2002-03-04' AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_nMonthsBefore,2.252,39203.02,2261.32,1,1,0
" derived from q92, udf in predicate, improv using cache","EXPLAIN ANALYZE  SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_nMonthsBefore_cache(d_Date_string, 3) between '2000-05-04' and '2030-10-05' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    sudf_nMonthsBefore_cache(d_Date_string, 3) between '1981-08-09' and '2002-03-04' AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_nMonthsBefore_cache,2.261,39203.02,1557.484667,1,1.451905144,1
" derived from q92, udf in predicate, no improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_nmonthsbefore(d_Date_string,6) between '2001-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_nMonthsBefore,2.239,36588.75,1028.583667,1,1,0
" derived from q92, udf in predicate, no improv using cache","EXPLAIN ANALYZE  SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_nMonthsBefore_cache(d_Date_string,6) between '2001-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_nMonthsBefore_cache,2.289,36588.75,1029.008667,1,0.999586981,0
" derived from q92, udf in predicate and projection, improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt), sudf_nmonthsbefore(d_Date_string, 8) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_nmonthsbefore(d_Date_string, 8) between '1995-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND sudf_nmonthsbefore(d_Date_string, 8) between '1901-03-04' and '2002-03-04' AND    d_date_sk = ws_sold_date_sk) GROUP BY sudf_nmonthsbefore(d_Date_string, 8) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_nMonthsBefore,1.817,39203.54,2220.843333,1,1,0
" derived from q92, udf in predicate and projection, improv using cache","EXPLAIN ANALYZE  SELECT Sum(ws_ext_discount_amt), sudf_nMonthsBefore_cache(d_Date_string, 8) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_nMonthsBefore_cache(d_Date_string, 8) between '1995-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND sudf_nMonthsBefore_cache(d_Date_string, 8) between '1901-03-04' and '2002-03-04' AND    d_date_sk = ws_sold_date_sk) GROUP BY sudf_nMonthsBefore_cache(d_Date_string, 8) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_nMonthsBefore_cache,2.437,39203.54,1558.892,1,1.424629374,1
" derived from q92, udf in predicate, no improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_nmonthsbefore(i_rec_start_date_string,5) between '1990-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND sudf_nmonthsbefore(i_rec_end_date_string,5) between '1980-03-04' and '2002-03-04' AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_nMonthsBefore,2.302,29923.66,1488.151333,1,1,0
" derived from q92, udf in predicate, no improv using cache","EXPLAIN ANALYZE  SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_nMonthsBefore_cache(i_rec_start_date_string,5) between '1990-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND sudf_nMonthsBefore_cache(i_rec_end_date_string,5) between '1980-03-04' and '2002-03-04' AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_nMonthsBefore_cache,2.378,29923.66,1097.103333,1,1.356436799,1
" derived from q92, udf in predicate, improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_nmonthsbefore(i_rec_start_date_string,1) between '2000-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_nMonthsBefore,2.113,28801.58,741.069,1,1,0
" derived from q92, udf in predicate, improv using cache","EXPLAIN ANALYZE  SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_nMonthsBefore_cache(i_rec_start_date_string,1) between '2000-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_nMonthsBefore_cache,2.13,28801.58,742.6116667,1,0.997922647,0
" derived from q67, udf in predicate, no improv using cache","EXPLAIN ANALYZE select * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 and sudf_nmonthsbefore(s_rec_start_date_string, 4) between '1900-10-04' and '2008-03-04' group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk LIMIT 100",sudf_nMonthsBefore,2.722,92189.16,13886.899,1,1,0
" derived from q67, udf in predicate, no improv using cache","EXPLAIN ANALYZE  select * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 and sudf_nMonthsBefore_cache(s_rec_start_date_string, 4) between '1900-10-04' and '2008-03-04' group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk LIMIT 100",sudf_nMonthsBefore_cache,2.714,92189.16,14009.61733,1,0.991240422,0
" derived from q67, udf in predicate, no improv using cache","EXPLAIN ANALYZE select * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 and sudf_nmonthsbefore(s_rec_start_date_string, 3) between '1900-10-04' and '2008-03-04' and sudf_nmonthsbefore(s_rec_end_date_string, 3) between '2008-03-04' and '2028-03-04' group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk LIMIT 100",sudf_nMonthsBefore,2.536,92204.31,716.085,1,1,0
" derived from q67, udf in predicate, no improv using cache","EXPLAIN ANALYZE  select * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 and sudf_nMonthsBefore_cache(s_rec_start_date_string, 3) between '1900-10-04' and '2008-03-04' and sudf_nMonthsBefore_cache(s_rec_end_date_string, 3) between '2008-03-04' and '2028-03-04' group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk LIMIT 100",sudf_nMonthsBefore_cache,2.805,92204.31,702.4986667,1,1.019340013,1
" derived from sqlprocbench, udf in both predicate and projection, bigdifference using result cache","EXPLAIN ANALYZE select c_customer_sk, sudf_12_increaseInWebSpending(c_customer_sk) from customer where c_customer_sk in (select ws_bill_customer_sk from web_sales_history, date_dim where d_date_sk = ws_sold_date_sk and d_year = 2000  INTERSECT  select ws_bill_customer_sk from web_sales_history, date_dim where d_date_sk = ws_sold_date_sk and d_year = 2001 ) and sudf_12_increaseInWebSpending(c_customer_sk) > 0 limit 10",sudf_12_increaseInWebSpending,1.271,5934.15,8997.368333,1,1,0
" derived from sqlprocbench, udf in both predicate and projection, bigdifference using result cache","EXPLAIN ANALYZE  select c_customer_sk, sudf_12_increaseInWebSpending_cache(c_customer_sk) from customer where c_customer_sk in (select ws_bill_customer_sk from web_sales_history, date_dim where d_date_sk = ws_sold_date_sk and d_year = 2000  INTERSECT  select ws_bill_customer_sk from web_sales_history, date_dim where d_date_sk = ws_sold_date_sk and d_year = 2001 ) and sudf_12_increaseInWebSpending_cache(c_customer_sk) > 0 limit 10",sudf_12_increaseInWebSpending_cache,1.219,5934.15,6579.930667,1,1.367395614,1
" derived from q45, udf in projection, no significant difference using result cache","EXPLAIN ANALYZE select c1, c2, sudf_12_increaseInWebSpending(c_customer_sk) from (SELECT ca_zip, ca_state c1, Sum(ws_sales_price) c2, c_customer_sk FROM   web_sales, customer, customer_address, date_dim, item WHERE  ws_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792' ) OR i_item_id IN (SELECT i_item_id FROM   item WHERE  i_item_sk IN ( 2, 3, 5, 7, 11, 13, 17, 19, 23, 29 )) ) AND ws_sold_date_sk = d_date_sk AND d_qoy = 1 AND d_year = 2000 GROUP  BY ca_zip, ca_state, c_customer_sk ORDER  BY ca_zip, ca_state) t",sudf_12_increaseInWebSpending,2.834,34534.89,4945.317333,1,1,0
" derived from q45, udf in projection, no significant difference using result cache","EXPLAIN ANALYZE  select c1, c2, sudf_12_increaseInWebSpending_cache(c_customer_sk) from (SELECT ca_zip, ca_state c1, Sum(ws_sales_price) c2, c_customer_sk FROM   web_sales, customer, customer_address, date_dim, item WHERE  ws_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792' ) OR i_item_id IN (SELECT i_item_id FROM   item WHERE  i_item_sk IN ( 2, 3, 5, 7, 11, 13, 17, 19, 23, 29 )) ) AND ws_sold_date_sk = d_date_sk AND d_qoy = 1 AND d_year = 2000 GROUP  BY ca_zip, ca_state, c_customer_sk ORDER  BY ca_zip, ca_state) t",sudf_12_increaseInWebSpending_cache,3.058,34534.89,4805.404667,1,1.029115689,1
" derived from q45, udf in projection and predicate, no difference using resultcache","EXPLAIN ANALYZE select c1, c2, sudf_12_increaseInWebSpending(c_customer_sk) from (SELECT ca_zip, ca_state c1, Sum(ws_sales_price) c2, c_customer_sk FROM   web_sales, customer, customer_address, date_dim, item WHERE  ws_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792' ) OR i_item_id IN (SELECT i_item_id FROM   item WHERE  i_item_sk IN ( 2, 3, 5, 7, 11, 13, 17, 19, 23, 29 )) ) AND ws_sold_date_sk = d_date_sk AND d_qoy = 1 AND d_year = 2000 GROUP  BY ca_zip, ca_state, c_customer_sk ORDER  BY ca_zip, ca_state) t where sudf_12_increaseInWebSpending(c_customer_sk) > 0",sudf_12_increaseInWebSpending,3.068,34571.46,5230.490667,1,1,0
" derived from q45, udf in projection and predicate, no difference using resultcache","EXPLAIN ANALYZE  select c1, c2, sudf_12_increaseInWebSpending_cache(c_customer_sk) from (SELECT ca_zip, ca_state c1, Sum(ws_sales_price) c2, c_customer_sk FROM   web_sales, customer, customer_address, date_dim, item WHERE  ws_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792' ) OR i_item_id IN (SELECT i_item_id FROM   item WHERE  i_item_sk IN ( 2, 3, 5, 7, 11, 13, 17, 19, 23, 29 )) ) AND ws_sold_date_sk = d_date_sk AND d_qoy = 1 AND d_year = 2000 GROUP  BY ca_zip, ca_state, c_customer_sk ORDER  BY ca_zip, ca_state) t where sudf_12_increaseInWebSpending_cache(c_customer_sk) > 0",sudf_12_increaseInWebSpending_cache,3.076,34571.46,4989.227,1,1.048356923,1
" derived from sqlprocbench, udf in projection, no difference using cache",EXPLAIN ANALYZE select s_store_sk from store where sudf_15_incomeBandOfMaxBuy(s_store_sk)='lowerMiddle' order by s_store_sk,sudf_15_incomeBandOfMaxBuy,0.657,17.89,20324.16,1,1,0
" derived from sqlprocbench, udf in projection, no difference using cache",EXPLAIN ANALYZE  select s_store_sk from store where sudf_15_incomeBandOfMaxBuy_cache(s_store_sk)='lowerMiddle' order by s_store_sk,sudf_15_incomeBandOfMaxBuy_cache,0.732,17.89,20678.023,1,0.982887,0
" derived from q65, udf in predicate, no difference using cache","EXPLAIN ANALYZE SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM   store, item, (SELECT ss_store_sk, Avg(revenue) AS ave FROM   (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sa GROUP  BY ss_store_sk) sb, (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sc WHERE  sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND sudf_15_incomeBandOfMaxBuy(s_store_sk)='lowerMiddle' ORDER  BY s_store_name, i_item_desc LIMIT 100",sudf_15_incomeBandOfMaxBuy,2.315,188287.98,23832.40367,1,1,0
" derived from q65, udf in predicate, no difference using cache","EXPLAIN ANALYZE  SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM   store, item, (SELECT ss_store_sk, Avg(revenue) AS ave FROM   (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sa GROUP  BY ss_store_sk) sb, (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sc WHERE  sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND sudf_15_incomeBandOfMaxBuy_cache(s_store_sk)='lowerMiddle' ORDER  BY s_store_name, i_item_desc LIMIT 100",sudf_15_incomeBandOfMaxBuy_cache,2.528,188287.98,23613.72767,1,1.009260546,1
" derived from q65, udf in both predicate and projection, big improv using cache","EXPLAIN ANALYZE SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand, sudf_15_incomeBandOfMaxBuy(s_store_sk) FROM   store, item, (SELECT ss_store_sk, Avg(revenue) AS ave FROM   (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sa GROUP  BY ss_store_sk) sb, (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sc WHERE  sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND sudf_15_incomeBandOfMaxBuy(s_store_sk) in ('lowerMiddle', 'low') ORDER  BY s_store_name, i_item_desc LIMIT 100",sudf_15_incomeBandOfMaxBuy,0,0,120000,1,1,0
" derived from q65, udf in both predicate and projection, big improv using cache","EXPLAIN ANALYZE  SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand, sudf_15_incomeBandOfMaxBuy_cache(s_store_sk) FROM   store, item, (SELECT ss_store_sk, Avg(revenue) AS ave FROM   (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sa GROUP  BY ss_store_sk) sb, (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sc WHERE  sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND sudf_15_incomeBandOfMaxBuy_cache(s_store_sk) in ('lowerMiddle', 'low') ORDER  BY s_store_name, i_item_desc LIMIT 100",sudf_15_incomeBandOfMaxBuy_cache,2.744,188333.09,23351.12,0,5.138939802,1
" derived from q13, udf in projection, no difference using cache","EXPLAIN ANALYZE SELECT Avg(ss_quantity), Avg(ss_ext_sales_price), Avg(ss_ext_wholesale_cost), Sum(ss_ext_wholesale_cost), sudf_1_totalLargePurchases(ca_state, 1000, d_year, d_qoy) FROM   store_sales, store, customer_demographics, household_demographics, customer_address, date_dim WHERE  s_store_sk = ss_store_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2001 AND ( ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'U' AND cd_education_status = 'Advanced Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3 ) OR ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1 ) OR ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = 'Secondary' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1 ) ) AND ( ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'AZ', 'NE', 'IA' ) AND ss_net_profit BETWEEN 100 AND 200 ) OR ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'MS', 'CA', 'NV' ) AND ss_net_profit BETWEEN 150 AND 300 ) OR ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'GA', 'TX', 'NJ' ) AND ss_net_profit BETWEEN 50 AND 250 ) ) group by ca_state, d_year, d_qoy",sudf_1_totalLargePurchases,3.969,170930.57,12293.10133,1,1,0
" derived from q13, udf in projection, no difference using cache","EXPLAIN ANALYZE  SELECT Avg(ss_quantity), Avg(ss_ext_sales_price), Avg(ss_ext_wholesale_cost), Sum(ss_ext_wholesale_cost), sudf_1_totalLargePurchases_cache(ca_state, 1000, d_year, d_qoy) FROM   store_sales, store, customer_demographics, household_demographics, customer_address, date_dim WHERE  s_store_sk = ss_store_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2001 AND ( ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'U' AND cd_education_status = 'Advanced Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3 ) OR ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1 ) OR ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = 'Secondary' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1 ) ) AND ( ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'AZ', 'NE', 'IA' ) AND ss_net_profit BETWEEN 100 AND 200 ) OR ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'MS', 'CA', 'NV' ) AND ss_net_profit BETWEEN 150 AND 300 ) OR ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'GA', 'TX', 'NJ' ) AND ss_net_profit BETWEEN 50 AND 250 ) ) group by ca_state, d_year, d_qoy",sudf_1_totalLargePurchases_cache,3.961,170930.57,12689.07433,1,0.968794178,0
" derived from q91, udf in filter predicate, significant difference using cache","EXPLAIN ANALYZE SELECT cc_call_center_id Call_Center, cc_name           Call_Center_Name, cc_manager        Manager, Sum(cr_net_loss)  Returns_Loss FROM   call_center, catalog_returns, date_dim, customer, customer_address, customer_demographics, household_demographics WHERE  cr_call_center_sk = cc_call_center_sk AND cr_returned_date_sk = d_date_sk AND cr_returning_customer_sk = c_customer_sk AND cd_demo_sk = c_current_cdemo_sk AND hd_demo_sk = c_current_hdemo_sk AND ca_address_sk = c_current_addr_sk AND d_year = 1999 AND d_moy = 12 AND ( ( cd_marital_status = 'M' AND cd_education_status = 'Unknown' ) OR ( cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree' ) ) AND hd_buy_potential LIKE 'Unknown%' AND ca_gmt_offset = -7 AND sudf_1_totalLargePurchases(ca_state, 1000, d_year, d_qoy) > 100 GROUP  BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER  BY Sum(cr_net_loss) DESC",sudf_1_totalLargePurchases,4.071,8885.31,91992.077,1,1,0
" derived from q91, udf in filter predicate, significant difference using cache","EXPLAIN ANALYZE  SELECT cc_call_center_id Call_Center, cc_name           Call_Center_Name, cc_manager        Manager, Sum(cr_net_loss)  Returns_Loss FROM   call_center, catalog_returns, date_dim, customer, customer_address, customer_demographics, household_demographics WHERE  cr_call_center_sk = cc_call_center_sk AND cr_returned_date_sk = d_date_sk AND cr_returning_customer_sk = c_customer_sk AND cd_demo_sk = c_current_cdemo_sk AND hd_demo_sk = c_current_hdemo_sk AND ca_address_sk = c_current_addr_sk AND d_year = 1999 AND d_moy = 12 AND ( ( cd_marital_status = 'M' AND cd_education_status = 'Unknown' ) OR ( cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree' ) ) AND hd_buy_potential LIKE 'Unknown%' AND ca_gmt_offset = -7 AND sudf_1_totalLargePurchases_cache(ca_state, 1000, d_year, d_qoy) > 100 GROUP  BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER  BY Sum(cr_net_loss) DESC",sudf_1_totalLargePurchases_cache,6.088,8885.31,17109.396,1,5.376699271,1
" derived from q91, udf in filter predicate, big difference using cache","EXPLAIN ANALYZE SELECT cc_call_center_id Call_Center, cc_name           Call_Center_Name, cc_manager        Manager, Sum(cr_net_loss)  Returns_Loss FROM   call_center, catalog_returns, date_dim, customer, customer_address, customer_demographics, household_demographics WHERE  cr_call_center_sk = cc_call_center_sk AND cr_returned_date_sk = d_date_sk AND cr_returning_customer_sk = c_customer_sk AND cd_demo_sk = c_current_cdemo_sk AND hd_demo_sk = c_current_hdemo_sk AND ca_address_sk = c_current_addr_sk AND d_year = 1999 AND d_moy = 12 AND ( ( cd_marital_status = 'M' AND cd_education_status = 'Unknown' ) OR ( cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree' ) ) AND hd_buy_potential LIKE 'Unknown%' AND ca_gmt_offset = -7 AND sudf_1_totalLargePurchases(ca_state, 1000, d_year, d_qoy) is not null AND sudf_1_totalLargePurchases(ca_state, 1000, d_year, d_qoy) > 100 GROUP  BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER  BY Sum(cr_net_loss) DESC",sudf_1_totalLargePurchases,0,0,120000,1,1,0
" derived from q91, udf in filter predicate, big difference using cache","EXPLAIN ANALYZE  SELECT cc_call_center_id Call_Center, cc_name           Call_Center_Name, cc_manager        Manager, Sum(cr_net_loss)  Returns_Loss FROM   call_center, catalog_returns, date_dim, customer, customer_address, customer_demographics, household_demographics WHERE  cr_call_center_sk = cc_call_center_sk AND cr_returned_date_sk = d_date_sk AND cr_returning_customer_sk = c_customer_sk AND cd_demo_sk = c_current_cdemo_sk AND hd_demo_sk = c_current_hdemo_sk AND ca_address_sk = c_current_addr_sk AND d_year = 1999 AND d_moy = 12 AND ( ( cd_marital_status = 'M' AND cd_education_status = 'Unknown' ) OR ( cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree' ) ) AND hd_buy_potential LIKE 'Unknown%' AND ca_gmt_offset = -7 AND sudf_1_totalLargePurchases_cache(ca_state, 1000, d_year, d_qoy) is not null AND sudf_1_totalLargePurchases_cache(ca_state, 1000, d_year, d_qoy) > 100 GROUP  BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER  BY Sum(cr_net_loss) DESC",sudf_1_totalLargePurchases_cache,4.05,8887.58,16668.21967,0,7.199329167,1
" derived from q92, udf in predicate, small improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_dateformat(d_Date_string) between '2000-05-04' and '2030-10-05' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND sudf_dateformat(d_Date_string) is not null AND    sudf_dateformat(d_Date_string) between '1981-08-09' and '2002-03-04' AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_dateformat,2.264,39346.04,2407.205667,1,1,0
" derived from q92, udf in predicate, small improv using cache","EXPLAIN ANALYZE  SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_dateformat_cache(d_Date_string) between '2000-05-04' and '2030-10-05' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND sudf_dateformat_cache(d_Date_string) is not null AND    sudf_dateformat_cache(d_Date_string) between '1981-08-09' and '2002-03-04' AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_dateformat_cache,2.208,39346.04,1583.222667,1,1.520446692,1
" derived from q92, udf in predicate, no improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND sudf_dateformat(d_Date_string) is not null AND      sudf_dateformat(d_Date_string) between '2001-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_dateformat,1.972,36642,1046.547667,1,1,0
" derived from q92, udf in predicate, no improv using cache","EXPLAIN ANALYZE  SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND sudf_dateformat_cache(d_Date_string) is not null AND      sudf_dateformat_cache(d_Date_string) between '2001-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_dateformat_cache,2.23,36642,1055.262667,1,0.991741393,0
" derived from q92, udf in predicate and projection, small improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt), sudf_dateformat(d_Date_string) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND sudf_dateformat(d_Date_string) is not null AND      sudf_dateformat(d_Date_string) between '1995-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND sudf_dateformat(d_Date_string) is not null and sudf_dateformat(d_Date_string) between '1981-01-15' and '2002-03-04' AND    d_date_sk = ws_sold_date_sk) GROUP BY sudf_dateformat(d_Date_string) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_dateformat,2.469,39399.81,2388.86,1,1,0
" derived from q92, udf in predicate and projection, small improv using cache","EXPLAIN ANALYZE  SELECT Sum(ws_ext_discount_amt), sudf_dateformat_cache(d_Date_string) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND sudf_dateformat_cache(d_Date_string) is not null AND      sudf_dateformat_cache(d_Date_string) between '1995-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND sudf_dateformat_cache(d_Date_string) is not null and sudf_dateformat_cache(d_Date_string) between '1981-01-15' and '2002-03-04' AND    d_date_sk = ws_sold_date_sk) GROUP BY sudf_dateformat_cache(d_Date_string) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_dateformat_cache,1.993,39399.81,1641.799333,1,1.455025563,1
" derived from q67, udf in predicate, no improv using cache","EXPLAIN ANALYZE select * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 and sudf_dateformat(s_rec_start_date_string) is not null and sudf_dateformat(s_rec_start_date_string) between '1900-10-04' and '2008-03-04' group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk LIMIT 100",sudf_dateformat,2.721,92196.66,14076.99533,1,1,0
" derived from q67, udf in predicate, no improv using cache","EXPLAIN ANALYZE  select * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 and sudf_dateformat_cache(s_rec_start_date_string) is not null and sudf_dateformat_cache(s_rec_start_date_string) between '1900-10-04' and '2008-03-04' group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk LIMIT 100",sudf_dateformat_cache,2.833,92196.66,13784.26767,1,1.02123636,1
" derived from q67, udf in predicate, no improv using cache","EXPLAIN ANALYZE select * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 and sudf_dateformat(s_rec_start_date_string) is not null and sudf_dateformat(s_rec_end_date_string) is not null and sudf_dateformat(s_rec_start_date_string) between '1900-10-04' and '2008-03-04' and sudf_dateformat(s_rec_end_date_string) between '2008-03-04' and '2028-03-04' group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk LIMIT 100",sudf_dateformat,2.787,92219.31,731.0033333,1,1,0
" derived from q67, udf in predicate, no improv using cache","EXPLAIN ANALYZE  select * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 and sudf_dateformat_cache(s_rec_start_date_string) is not null and sudf_dateformat_cache(s_rec_end_date_string) is not null and sudf_dateformat_cache(s_rec_start_date_string) between '1900-10-04' and '2008-03-04' and sudf_dateformat_cache(s_rec_end_date_string) between '2008-03-04' and '2028-03-04' group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk LIMIT 100",sudf_dateformat_cache,2.805,92219.31,728.4066667,1,1.003564858,1
" derived from sqlprocbench, udf in predicate, no improv using cache","EXPLAIN ANALYZE select ws_item_sk from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20b_GetManufactComplex(ws_item_sk) = 'oughtn st'",sudf_20b_GetManufactComplex,0.749,25102.52,26818.63933,1,1,0
" derived from sqlprocbench, udf in predicate, no improv using cache","EXPLAIN ANALYZE  select ws_item_sk from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20b_GetManufactComplex_cache(ws_item_sk) = 'oughtn st'",sudf_20b_GetManufactComplex_cache,0.75,25102.52,27861.612,1,0.962565961,0
" derived from sqlprocbench, udf in predicate, no improv using cache","EXPLAIN ANALYZE select ws_item_sk from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20b_GetManufactComplex(ws_item_sk) is not null and sudf_20b_GetManufactComplex(ws_item_sk) = 'oughtn st'",sudf_20b_GetManufactComplex,0.753,25110.02,55253.42867,1,1,0
" derived from sqlprocbench, udf in predicate, no improv using cache","EXPLAIN ANALYZE  select ws_item_sk from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20b_GetManufactComplex_cache(ws_item_sk) is not null and sudf_20b_GetManufactComplex_cache(ws_item_sk) = 'oughtn st'",sudf_20b_GetManufactComplex_cache,0.752,25110.02,55229.36033,1,1.000435789,1
" derived from sqlprocbench, udf in both predicate and projection, no improv using cache","EXPLAIN ANALYZE select ws_item_sk, sudf_20b_GetManufactComplex(ws_item_sk) from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20b_GetManufactComplex(ws_item_sk) != 'outdated item'",sudf_20b_GetManufactComplex,0.732,25109.77,30807.841,1,1,0
" derived from sqlprocbench, udf in both predicate and projection, no improv using cache","EXPLAIN ANALYZE  select ws_item_sk, sudf_20b_GetManufactComplex_cache(ws_item_sk) from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20b_GetManufactComplex_cache(ws_item_sk) != 'outdated item'",sudf_20b_GetManufactComplex_cache,0.954,25109.77,30793.20733,1,1.000475224,1
" derived from sqlprocbench, udf in both predicate and projection, no improv using cache","EXPLAIN ANALYZE select ws_item_sk, sudf_20b_GetManufactComplex(ws_item_sk) from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20b_GetManufactComplex(ws_item_sk) in ('outdated item', 'oughtn st')",sudf_20b_GetManufactComplex,1.03,25103.02,52530.62533,1,1,0
" derived from sqlprocbench, udf in both predicate and projection, no improv using cache","EXPLAIN ANALYZE  select ws_item_sk, sudf_20b_GetManufactComplex_cache(ws_item_sk) from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20b_GetManufactComplex_cache(ws_item_sk) in ('outdated item', 'oughtn st')",sudf_20b_GetManufactComplex_cache,1.107,25103.02,50592.51567,1,1.038308229,1
" derived from sqlprocbench, udf in projection, small improvement using result cache","EXPLAIN ANALYZE select i_manufact_id, sudf_6_totalDiscount(i_manufact_id) as totalDisc from item limit 20",sudf_6_totalDiscount,0.535,9.35,12921.62633,1,1,0
" derived from sqlprocbench, udf in projection, small improvement using result cache","EXPLAIN ANALYZE  select i_manufact_id, sudf_6_totalDiscount_cache(i_manufact_id) as totalDisc from item limit 20",sudf_6_totalDiscount_cache,0.521,9.35,9479.553667,1,1.36310493,1
" derived from q67, udf in projection, big difference using result cache","EXPLAIN ANALYZE select from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales, discount ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id, sudf_6_totalDiscount(i_manufact_id) discount ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store , (select * from item limit 100) t where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+1 group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id, discount))dw1 limit 100) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100",sudf_6_totalDiscount,0,0,120000,1,1,0
" derived from q67, udf in projection, big difference using result cache","EXPLAIN ANALYZE  select from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales, discount ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id, sudf_6_totalDiscount_cache(i_manufact_id) discount ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store , (select * from item limit 100) t where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+1 group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id, discount))dw1 limit 100) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100",sudf_6_totalDiscount_cache,2.41,59270.83,33719.83933,0,3.558735818,1
" derived from q65, udf in projection, no difference using result cache","EXPLAIN ANALYZE SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand, sudf_6_totalDiscount(i_manufact_id) FROM   store, item, (SELECT ss_store_sk, Avg(revenue) AS ave FROM   (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sa GROUP  BY ss_store_sk) sb, (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sc WHERE  sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk ORDER  BY s_store_name, i_item_desc LIMIT 100",sudf_6_totalDiscount,2.626,189289.86,70260.89333,1,1,0
" derived from q65, udf in projection, no difference using result cache","EXPLAIN ANALYZE  SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand, sudf_6_totalDiscount_cache(i_manufact_id) FROM   store, item, (SELECT ss_store_sk, Avg(revenue) AS ave FROM   (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sa GROUP  BY ss_store_sk) sb, (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sc WHERE  sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk ORDER  BY s_store_name, i_item_desc LIMIT 100",sudf_6_totalDiscount_cache,2.517,189289.86,64918.90533,1,1.082287093,1
" derived from q92, udf in predicate, big difference using result cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      d_date BETWEEN '2002-03-29' AND      ( Cast('2002-03-29' AS DATE) +  INTERVAL '90' day) AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date BETWEEN '2002-03-29' AND    ( cast('2002-03-29' AS date) + INTERVAL '90' day) AND    d_date_sk = ws_sold_date_sk) AND sudf_6_totalDiscount(i_manufact_id) > 100 ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_6_totalDiscount,1.747,41926.8,5671.613333,1,1,0
" derived from q92, udf in predicate, big difference using result cache","EXPLAIN ANALYZE  SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      d_date BETWEEN '2002-03-29' AND      ( Cast('2002-03-29' AS DATE) +  INTERVAL '90' day) AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date BETWEEN '2002-03-29' AND    ( cast('2002-03-29' AS date) + INTERVAL '90' day) AND    d_date_sk = ws_sold_date_sk) AND sudf_6_totalDiscount_cache(i_manufact_id) > 100 ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_6_totalDiscount_cache,1.862,41926.8,1691.298,1,3.353408644,1
" derived from sqlprocbench, udf in predicate, no difference using cache","EXPLAIN ANALYZE select ws_item_sk from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20a_GetManufactSimple(ws_item_sk) = 'oughtn st'",sudf_20a_GetManufactSimple,0.644,25102.52,995.13,1,1,0
" derived from sqlprocbench, udf in predicate, no difference using cache","EXPLAIN ANALYZE  select ws_item_sk from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20a_GetManufactSimple_cache(ws_item_sk) = 'oughtn st'",sudf_20a_GetManufactSimple_cache,0.651,25102.52,983.8516667,1,1.011463449,1
" derived from sqlprocbench, udf in predicate, no difference using cache","EXPLAIN ANALYZE select ws_item_sk from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20a_GetManufactSimple(ws_item_sk) is not null and sudf_20a_GetManufactSimple(ws_item_sk) = 'oughtn st'",sudf_20a_GetManufactSimple,0.674,25110.02,1007.353667,1,1,0
" derived from sqlprocbench, udf in predicate, no difference using cache","EXPLAIN ANALYZE  select ws_item_sk from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20a_GetManufactSimple_cache(ws_item_sk) is not null and sudf_20a_GetManufactSimple_cache(ws_item_sk) = 'oughtn st'",sudf_20a_GetManufactSimple_cache,0.528,25110.02,998.8783333,1,1.008484851,1
" derived from sqlprocbench, udf in both predicate and projection, no improv using cache","EXPLAIN ANALYZE select ws_item_sk, sudf_20a_GetManufactSimple(ws_item_sk) from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20a_GetManufactSimple(ws_item_sk) != 'outdated item'",sudf_20a_GetManufactSimple,0.555,25109.77,996.71,1,1,0
" derived from sqlprocbench, udf in both predicate and projection, no improv using cache","EXPLAIN ANALYZE  select ws_item_sk, sudf_20a_GetManufactSimple_cache(ws_item_sk) from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20a_GetManufactSimple_cache(ws_item_sk) != 'outdated item'",sudf_20a_GetManufactSimple_cache,0.507,25109.77,985.182,1,1.011701391,1
" derived from sqlprocbench, udf in both predicate and projection, no improv using cache","EXPLAIN ANALYZE select ws_item_sk, sudf_20a_GetManufactSimple(ws_item_sk) from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20a_GetManufactSimple(ws_item_sk) in ('outdated item', 'oughtn st')",sudf_20a_GetManufactSimple,0.734,25103.02,986.3466667,1,1,0
" derived from sqlprocbench, udf in both predicate and projection, no improv using cache","EXPLAIN ANALYZE  select ws_item_sk, sudf_20a_GetManufactSimple_cache(ws_item_sk) from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20a_GetManufactSimple_cache(ws_item_sk) in ('outdated item', 'oughtn st')",sudf_20a_GetManufactSimple_cache,0.853,25103.02,975.0623333,1,1.011572935,1
" derived from q92, udf in predicate, big improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      d_date BETWEEN '2002-03-29' AND      ( Cast('2002-03-29' AS DATE) +  INTERVAL '90' day) AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date BETWEEN '2002-03-29' AND    ( cast('2002-03-29' AS date) + INTERVAL '90' day) AND    d_date_sk = ws_sold_date_sk AND sudf_20a_GetManufactSimple(ws_item_sk) = 'oughtn st') ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_20a_GetManufactSimple,1.594,34412.3,3005.963333,1,1,0
" derived from q92, udf in predicate, big improv using cache","EXPLAIN ANALYZE  SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      d_date BETWEEN '2002-03-29' AND      ( Cast('2002-03-29' AS DATE) +  INTERVAL '90' day) AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date BETWEEN '2002-03-29' AND    ( cast('2002-03-29' AS date) + INTERVAL '90' day) AND    d_date_sk = ws_sold_date_sk AND sudf_20a_GetManufactSimple_cache(ws_item_sk) = 'oughtn st') ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_20a_GetManufactSimple_cache,1.697,34412.3,1220.922333,1,2.46204304,1
" derived from q75, udf in predicate, big improv using cache","EXPLAIN ANALYZE WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' AND sudf_20a_GetManufactSimple(ws_item_sk) = 'oughtn st') sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_20a_GetManufactSimple,5.217,389410.94,14057.191,1,1,0
" derived from q75, udf in predicate, big improv using cache","EXPLAIN ANALYZE  WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' AND sudf_20a_GetManufactSimple_cache(ws_item_sk) = 'oughtn st') sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_20a_GetManufactSimple_cache,5.3,389410.94,7164.718333,1,1.962001902,1
" derived from q40, udf in projection and predicate, no improv using result cache","EXPLAIN ANALYZE SELECT w_state , i_item_id , Sum( CASE WHEN ( Cast(d_date AS DATE) < Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_before , Sum( CASE WHEN ( Cast(d_date AS DATE) >= Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_after, sudf_max(cs_sales_price, i_current_price, cr_return_amt_inc_tax) as max FROM            catalog_sales LEFT OUTER JOIN catalog_returns ON              ( cs_order_number = cr_order_number AND             cs_item_sk = cr_item_sk) , warehouse , item , date_dim WHERE           i_current_price BETWEEN 0.99 AND             1.49 AND             i_item_sk = cs_item_sk AND             cs_warehouse_sk = w_warehouse_sk AND             cs_sold_date_sk = d_date_sk AND             d_date BETWEEN (Cast ('2002-06-01' AS DATE) - INTERVAL '30' day) AND             ( cast ('2002-06-01' AS date) + INTERVAL '30' day) AND sudf_max(cs_sales_price, i_current_price, cr_return_amt_inc_tax) > 30 GROUP BY        w_state, i_item_id, max ORDER BY        w_state, i_item_id ",sudf_max,3.568,61662.41,1372.031333,1,1,0
" derived from q40, udf in projection and predicate, no improv using result cache","EXPLAIN ANALYZE  SELECT w_state , i_item_id , Sum( CASE WHEN ( Cast(d_date AS DATE) < Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_before , Sum( CASE WHEN ( Cast(d_date AS DATE) >= Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_after, sudf_max_cache(cs_sales_price, i_current_price, cr_return_amt_inc_tax) as max FROM            catalog_sales LEFT OUTER JOIN catalog_returns ON              ( cs_order_number = cr_order_number AND             cs_item_sk = cr_item_sk) , warehouse , item , date_dim WHERE           i_current_price BETWEEN 0.99 AND             1.49 AND             i_item_sk = cs_item_sk AND             cs_warehouse_sk = w_warehouse_sk AND             cs_sold_date_sk = d_date_sk AND             d_date BETWEEN (Cast ('2002-06-01' AS DATE) - INTERVAL '30' day) AND             ( cast ('2002-06-01' AS date) + INTERVAL '30' day) AND sudf_max_cache(cs_sales_price, i_current_price, cr_return_amt_inc_tax) > 30 GROUP BY        w_state, i_item_id, max ORDER BY        w_state, i_item_id ",sudf_max_cache,3.599,61662.41,1372.430333,1,0.999709275,0
" derived from q40, udf in predicate, no improv using result cache","EXPLAIN ANALYZE SELECT w_state , i_item_id , Sum( CASE WHEN ( Cast(d_date AS DATE) < Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_before , Sum( CASE WHEN ( Cast(d_date AS DATE) >= Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_after FROM            catalog_sales LEFT OUTER JOIN catalog_returns ON              ( cs_order_number = cr_order_number AND             cs_item_sk = cr_item_sk) , warehouse , item , date_dim WHERE           i_current_price BETWEEN 0.99 AND             1.49 AND             i_item_sk = cs_item_sk AND             cs_warehouse_sk = w_warehouse_sk AND             cs_sold_date_sk = d_date_sk AND             d_date BETWEEN (Cast ('2002-06-01' AS DATE) - INTERVAL '30' day) AND             ( cast ('2002-06-01' AS date) + INTERVAL '30' day) AND sudf_max(cs_sales_price, i_current_price, cr_return_amt_inc_tax) > 1 GROUP BY        w_state, i_item_id ORDER BY        w_state, i_item_id ",sudf_max,3.418,61648.96,1344.113,1,1,0
" derived from q40, udf in predicate, no improv using result cache","EXPLAIN ANALYZE  SELECT w_state , i_item_id , Sum( CASE WHEN ( Cast(d_date AS DATE) < Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_before , Sum( CASE WHEN ( Cast(d_date AS DATE) >= Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_after FROM            catalog_sales LEFT OUTER JOIN catalog_returns ON              ( cs_order_number = cr_order_number AND             cs_item_sk = cr_item_sk) , warehouse , item , date_dim WHERE           i_current_price BETWEEN 0.99 AND             1.49 AND             i_item_sk = cs_item_sk AND             cs_warehouse_sk = w_warehouse_sk AND             cs_sold_date_sk = d_date_sk AND             d_date BETWEEN (Cast ('2002-06-01' AS DATE) - INTERVAL '30' day) AND             ( cast ('2002-06-01' AS date) + INTERVAL '30' day) AND sudf_max_cache(cs_sales_price, i_current_price, cr_return_amt_inc_tax) > 1 GROUP BY        w_state, i_item_id ORDER BY        w_state, i_item_id ",sudf_max_cache,3.723,61648.96,1359.211333,1,0.988891843,0
" derived from q75, udf in 1 predicate, no improv using result cache","EXPLAIN ANALYZE WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_max(ws_sales_price, i_current_price, wr_refunded_cash) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_max,5.819,324443.54,6430.376667,1,1,0
" derived from q75, udf in 1 predicate, no improv using result cache","EXPLAIN ANALYZE  WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_max_cache(ws_sales_price, i_current_price, wr_refunded_cash) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_max_cache,5.826,324443.54,6677.58,1,0.962980102,0
" derived from q75, udf in predicate, no improv using result cache","EXPLAIN ANALYZE WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' and sudf_max(ss_sales_price, i_current_price, sr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_max(ws_sales_price, i_current_price, wr_return_amt_inc_tax) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_max,6.765,282859.8,7897.828,1,1,0
" derived from q75, udf in predicate, no improv using result cache","EXPLAIN ANALYZE  WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' and sudf_max_cache(ss_sales_price, i_current_price, sr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_max_cache(ws_sales_price, i_current_price, wr_return_amt_inc_tax) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_max_cache,6.297,282859.8,8253.058,1,0.956957773,0
" derived from q75, udf in predicates, no improv using result cache","EXPLAIN ANALYZE WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' and sudf_max(cs_sales_price, i_current_price, cr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' and sudf_max(ss_sales_price, i_current_price, sr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_max(ws_sales_price, i_current_price, wr_return_amt_inc_tax) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_max,6.026,261466.63,8904.770333,1,1,0
" derived from q75, udf in predicates, no improv using result cache","EXPLAIN ANALYZE  WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' and sudf_max_cache(cs_sales_price, i_current_price, cr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' and sudf_max_cache(ss_sales_price, i_current_price, sr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_max_cache(ws_sales_price, i_current_price, wr_return_amt_inc_tax) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_max_cache,5.498,261466.63,9384.568667,1,0.948873694,0
" derived from sqlprocbench, udf in projection, small improvement using result cache","EXPLAIN ANALYZE select c_customer_sk, sudf_13_maxPurchaseChannel(c_customer_sk, 2000, 2020) as channel from customer limit 10",sudf_13_maxPurchaseChannel,0.364,2.88,11102.279,1,1,0
" derived from sqlprocbench, udf in projection, small improvement using result cache","EXPLAIN ANALYZE  select c_customer_sk, sudf_13_maxPurchaseChannel_cache(c_customer_sk, 2000, 2020) as channel from customer limit 10",sudf_13_maxPurchaseChannel_cache,0.595,2.88,11141.29733,1,0.996497864,0
" derived from q45, udf in projections, no difference using result cache","EXPLAIN ANALYZE SELECT ca_zip, ca_state, Sum(ws_sales_price), sudf_13_maxPurchaseChannel(c_customer_sk, 2000,2020) FROM   web_sales, customer, customer_address, date_dim, item WHERE  ws_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792' ) OR i_item_id IN (SELECT i_item_id FROM   item WHERE  i_item_sk IN ( 2, 3, 5, 7, 11, 13, 17, 19, 23, 29 )) ) AND ws_sold_date_sk = d_date_sk AND d_qoy = 1 AND d_year = 2000 GROUP  BY ca_zip, ca_state, c_customer_sk ORDER  BY ca_zip, ca_state LIMIT 10",sudf_13_maxPurchaseChannel,3.272,34405.69,11553.424,1,1,0
" derived from q45, udf in projections, no difference using result cache","EXPLAIN ANALYZE  SELECT ca_zip, ca_state, Sum(ws_sales_price), sudf_13_maxPurchaseChannel_cache(c_customer_sk, 2000,2020) FROM   web_sales, customer, customer_address, date_dim, item WHERE  ws_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792' ) OR i_item_id IN (SELECT i_item_id FROM   item WHERE  i_item_sk IN ( 2, 3, 5, 7, 11, 13, 17, 19, 23, 29 )) ) AND ws_sold_date_sk = d_date_sk AND d_qoy = 1 AND d_year = 2000 GROUP  BY ca_zip, ca_state, c_customer_sk ORDER  BY ca_zip, ca_state LIMIT 10",sudf_13_maxPurchaseChannel_cache,3.375,34405.69,12010.01067,1,0.961982826,0
" derived from q13, udf in projection, small difference using result cache","EXPLAIN ANALYZE SELECT Avg(ss_quantity), Avg(ss_ext_sales_price), Avg(ss_ext_wholesale_cost), Sum(ss_ext_wholesale_cost), sudf_13_maxPurchaseChannel(store_sales.ss_customer_sk, 2000,2020) mp FROM   store_sales, store, customer_demographics, household_demographics, customer_address, date_dim WHERE  s_store_sk = ss_store_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2001 AND ( ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'U' AND cd_education_status = 'Advanced Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3 ) OR ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1 ) OR ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = 'Secondary' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1 ) ) AND ( ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'AZ', 'NE', 'IA' ) AND ss_net_profit BETWEEN 100 AND 200 ) OR ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'MS', 'CA', 'NV' ) AND ss_net_profit BETWEEN 150 AND 300 ) OR ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'GA', 'TX', 'NJ' ) AND ss_net_profit BETWEEN 50 AND 250 ) ) GROUP BY mp",sudf_13_maxPurchaseChannel,3.929,170930.82,12737.13467,1,1,0
" derived from q13, udf in projection, small difference using result cache","EXPLAIN ANALYZE  SELECT Avg(ss_quantity), Avg(ss_ext_sales_price), Avg(ss_ext_wholesale_cost), Sum(ss_ext_wholesale_cost), sudf_13_maxPurchaseChannel_cache(store_sales.ss_customer_sk, 2000,2020) mp FROM   store_sales, store, customer_demographics, household_demographics, customer_address, date_dim WHERE  s_store_sk = ss_store_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2001 AND ( ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'U' AND cd_education_status = 'Advanced Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3 ) OR ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1 ) OR ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = 'Secondary' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1 ) ) AND ( ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'AZ', 'NE', 'IA' ) AND ss_net_profit BETWEEN 100 AND 200 ) OR ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'MS', 'CA', 'NV' ) AND ss_net_profit BETWEEN 150 AND 300 ) OR ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'GA', 'TX', 'NJ' ) AND ss_net_profit BETWEEN 50 AND 250 ) ) GROUP BY mp",sudf_13_maxPurchaseChannel_cache,4.062,170930.82,11157.05467,1,1.141621606,1
" derived from q67, udf in projection, no improv using cache","EXPLAIN ANALYZE select from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id, i_des ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id, sudf_string_manipulation(i_item_desc, ',',',') i_des, sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id, i_des))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100",sudf_string_manipulation,2.057,104712.58,27515.81633,1,1,0
" derived from q67, udf in projection, no improv using cache","EXPLAIN ANALYZE  select from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id, i_des ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id, sudf_string_manipulation_cache(i_item_desc, ',',',') i_des, sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id, i_des))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100",sudf_string_manipulation_cache,2.788,104712.58,27294.96433,1,1.008091309,1
" derived from q65, udf in projection, no improv using cache","EXPLAIN ANALYZE SELECT s_store_name, sudf_string_manipulation(i_item_desc, ',',',') i_des,               sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM   store, item, (SELECT ss_store_sk, Avg(revenue) AS ave FROM   (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sa GROUP  BY ss_store_sk) sb, (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sc WHERE  sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk ORDER  BY s_store_name, i_item_desc LIMIT 100",sudf_string_manipulation,2.221,189289.86,4111.501,1,1,0
" derived from q65, udf in projection, no improv using cache","EXPLAIN ANALYZE  SELECT s_store_name, sudf_string_manipulation_cache(i_item_desc, ',',',') i_des,               sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM   store, item, (SELECT ss_store_sk, Avg(revenue) AS ave FROM   (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sa GROUP  BY ss_store_sk) sb, (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sc WHERE  sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk ORDER  BY s_store_name, i_item_desc LIMIT 100",sudf_string_manipulation_cache,3.287,189289.86,3949.028,1,1.041142529,1
" derived from q67, udf in projection and predicate, no improv using cache","EXPLAIN ANALYZE select from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id, i_des ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id, sudf_string_manipulation(i_item_desc, ',',',') i_des, sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 and sudf_string_manipulation(i_item_desc, ',',',') is not null and sudf_string_manipulation(i_item_desc, ',',',') != '' group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id, i_des))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100",sudf_string_manipulation,2.675,111466.01,48346.07367,1,1,0
" derived from q67, udf in projection and predicate, no improv using cache","EXPLAIN ANALYZE  select from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id, i_des ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id, sudf_string_manipulation_cache(i_item_desc, ',',',') i_des, sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 and sudf_string_manipulation_cache(i_item_desc, ',',',') is not null and sudf_string_manipulation_cache(i_item_desc, ',',',') != '' group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id, i_des))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100",sudf_string_manipulation_cache,3.007,111466.01,45810.19167,1,1.055356284,1
" derived from q65, udf in projection and predicate, no improv using cache","EXPLAIN ANALYZE SELECT s_store_name, sudf_string_manipulation(i_item_desc, ',',',') i_des,               sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM   store, item, (SELECT ss_store_sk, Avg(revenue) AS ave FROM   (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sa GROUP  BY ss_store_sk) sb, (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sc WHERE  sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk and sudf_string_manipulation(i_item_desc, ',',',') is not null AND sudf_string_manipulation(i_item_desc, ',',',') != '' ORDER  BY s_store_name, i_item_desc LIMIT 100",sudf_string_manipulation,3.246,189646.37,4458.84,1,1,0
" derived from q65, udf in projection and predicate, no improv using cache","EXPLAIN ANALYZE  SELECT s_store_name, sudf_string_manipulation_cache(i_item_desc, ',',',') i_des,               sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM   store, item, (SELECT ss_store_sk, Avg(revenue) AS ave FROM   (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sa GROUP  BY ss_store_sk) sb, (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sc WHERE  sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk and sudf_string_manipulation_cache(i_item_desc, ',',',') is not null AND sudf_string_manipulation_cache(i_item_desc, ',',',') != '' ORDER  BY s_store_name, i_item_desc LIMIT 100",sudf_string_manipulation_cache,3.259,189646.37,4517.720333,1,0.986966804,0
" derived from q92, udf in predicate, no improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND sudf_string_manipulation(i_item_desc, ',',',') is not null and sudf_string_manipulation(i_item_desc, ',',',') != '' AND      i_item_sk = ws_item_sk AND      d_date BETWEEN '2002-03-29' AND      ( Cast('2002-03-29' AS DATE) +  INTERVAL '90' day) AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date BETWEEN '2002-03-29' AND    ( cast('2002-03-29' AS date) + INTERVAL '90' day) AND    d_date_sk = ws_sold_date_sk ) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_string_manipulation,2.273,46426.93,972.5806667,1,1,0
" derived from q92, udf in predicate, no improv using cache","EXPLAIN ANALYZE  SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND sudf_string_manipulation_cache(i_item_desc, ',',',') is not null and sudf_string_manipulation_cache(i_item_desc, ',',',') != '' AND      i_item_sk = ws_item_sk AND      d_date BETWEEN '2002-03-29' AND      ( Cast('2002-03-29' AS DATE) +  INTERVAL '90' day) AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date BETWEEN '2002-03-29' AND    ( cast('2002-03-29' AS date) + INTERVAL '90' day) AND    d_date_sk = ws_sold_date_sk ) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_string_manipulation_cache,2.319,46426.93,992.097,1,0.9803282,0
" derived from sqlprocbench, udf in predicate, big difference using result cache","EXPLAIN ANALYZE select * from (select * from store limit 10) as t where sudf_7_profitableManager(t.s_manager, 2001)<=0",sudf_7_profitableManager,0.774,6.06,11329.69067,1,1,0
" derived from sqlprocbench, udf in predicate, big difference using result cache","EXPLAIN ANALYZE  select * from (select * from store limit 10) as t where sudf_7_profitableManager_cache(t.s_manager, 2001)<=0",sudf_7_profitableManager_cache,0.559,6.06,6980.508333,1,1.62304665,1
" derived from q34, udf in predicate, big difference using result cache","EXPLAIN ANALYZE SELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM   (SELECT ss_ticket_number, ss_customer_sk, Count(*) cnt FROM   store_sales, date_dim, store, household_demographics WHERE  store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_store_sk = store.s_store_sk AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND ( date_dim.d_dom BETWEEN 1 AND 3 OR date_dim.d_dom BETWEEN 25 AND 28 ) AND ( household_demographics.hd_buy_potential = '>10000' OR household_demographics.hd_buy_potential = 'unknown' ) AND household_demographics.hd_vehicle_count > 0 AND ( CASE WHEN household_demographics.hd_vehicle_count > 0 THEN household_demographics.hd_dep_count / household_demographics.hd_vehicle_count ELSE NULL END ) > 1.2 AND date_dim.d_year IN ( 1999, 1999 + 1, 1999 + 2 ) AND store.s_county IN ( 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County' , 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County' ) And sudf_7_profitableManager(store.s_manager, 2001)<=0 GROUP  BY ss_ticket_number, ss_customer_sk) dn, customer WHERE  ss_customer_sk = c_customer_sk AND cnt BETWEEN 15 AND 20 ORDER  BY c_last_name, c_first_name, c_salutation, c_preferred_cust_flag DESC",sudf_7_profitableManager,2.557,89514.61,14219.48833,1,1,0
" derived from q34, udf in predicate, big difference using result cache","EXPLAIN ANALYZE  SELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM   (SELECT ss_ticket_number, ss_customer_sk, Count(*) cnt FROM   store_sales, date_dim, store, household_demographics WHERE  store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_store_sk = store.s_store_sk AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND ( date_dim.d_dom BETWEEN 1 AND 3 OR date_dim.d_dom BETWEEN 25 AND 28 ) AND ( household_demographics.hd_buy_potential = '>10000' OR household_demographics.hd_buy_potential = 'unknown' ) AND household_demographics.hd_vehicle_count > 0 AND ( CASE WHEN household_demographics.hd_vehicle_count > 0 THEN household_demographics.hd_dep_count / household_demographics.hd_vehicle_count ELSE NULL END ) > 1.2 AND date_dim.d_year IN ( 1999, 1999 + 1, 1999 + 2 ) AND store.s_county IN ( 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County' , 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County' ) And sudf_7_profitableManager_cache(store.s_manager, 2001)<=0 GROUP  BY ss_ticket_number, ss_customer_sk) dn, customer WHERE  ss_customer_sk = c_customer_sk AND cnt BETWEEN 15 AND 20 ORDER  BY c_last_name, c_first_name, c_salutation, c_preferred_cust_flag DESC",sudf_7_profitableManager_cache,3.596,89514.61,8834.838667,1,1.609479117,1
" derived from q34, udf in predicate, big difference using result cache","EXPLAIN ANALYZE SELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM   (SELECT ss_ticket_number, ss_customer_sk, Count(*) cnt FROM   store_sales, date_dim, store, household_demographics WHERE  store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_store_sk = store.s_store_sk AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND ( date_dim.d_dom BETWEEN 1 AND 3 OR date_dim.d_dom BETWEEN 25 AND 28 ) AND ( household_demographics.hd_buy_potential = '>10000' OR household_demographics.hd_buy_potential = 'unknown' ) AND household_demographics.hd_vehicle_count > 0 AND ( CASE WHEN household_demographics.hd_vehicle_count > 0 THEN household_demographics.hd_dep_count / household_demographics.hd_vehicle_count ELSE NULL END ) > 1.2 AND date_dim.d_year IN ( 1999, 1999 + 1, 1999 + 2 ) AND store.s_county IN ( 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County' , 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County' ) And sudf_7_profitableManager(store.s_manager, date_dim.d_year)<=0 GROUP  BY ss_ticket_number, ss_customer_sk) dn, customer WHERE  ss_customer_sk = c_customer_sk AND cnt BETWEEN 15 AND 20 ORDER  BY c_last_name, c_first_name, c_salutation, c_preferred_cust_flag DESC",sudf_7_profitableManager,0,0,120000,1,1,0
" derived from q34, udf in predicate, big difference using result cache","EXPLAIN ANALYZE  SELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM   (SELECT ss_ticket_number, ss_customer_sk, Count(*) cnt FROM   store_sales, date_dim, store, household_demographics WHERE  store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_store_sk = store.s_store_sk AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND ( date_dim.d_dom BETWEEN 1 AND 3 OR date_dim.d_dom BETWEEN 25 AND 28 ) AND ( household_demographics.hd_buy_potential = '>10000' OR household_demographics.hd_buy_potential = 'unknown' ) AND household_demographics.hd_vehicle_count > 0 AND ( CASE WHEN household_demographics.hd_vehicle_count > 0 THEN household_demographics.hd_dep_count / household_demographics.hd_vehicle_count ELSE NULL END ) > 1.2 AND date_dim.d_year IN ( 1999, 1999 + 1, 1999 + 2 ) AND store.s_county IN ( 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County' , 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County' ) And sudf_7_profitableManager_cache(store.s_manager, date_dim.d_year)<=0 GROUP  BY ss_ticket_number, ss_customer_sk) dn, customer WHERE  ss_customer_sk = c_customer_sk AND cnt BETWEEN 15 AND 20 ORDER  BY c_last_name, c_first_name, c_salutation, c_preferred_cust_flag DESC",sudf_7_profitableManager_cache,3.151,91631.18,21906.59833,0,5.477801627,1
" derived from sqlprocbench, udf in projection, no difference","EXPLAIN ANALYZE select t.depCount, sudf_5_morEveRatio(t.depCount) from (select distinct cd_dep_count as depCount from customer_demographics)t",sudf_5_morEveRatio,0.534,45839.89,5860.824667,1,1,0
" derived from sqlprocbench, udf in projection, no difference","EXPLAIN ANALYZE  select t.depCount, sudf_5_morEveRatio_cache(t.depCount) from (select distinct cd_dep_count as depCount from customer_demographics)t",sudf_5_morEveRatio_cache,0.573,45839.89,5991.607,1,0.978172411,0
" derived from q35, udf in projection, big difference using result cache","EXPLAIN ANALYZE SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, Count(*) cnt1, Stddev_samp(cd_dep_count), Avg(cd_dep_count), Max(cd_dep_count), sudf_5_morEveRatio(cd_dep_count) cd_dep_employed_count, Count(*) cnt2, Stddev_samp(cd_dep_employed_count), Avg(cd_dep_employed_count), Max(cd_dep_employed_count), cd_dep_college_count, Count(*) cnt3, Stddev_samp(cd_dep_college_count), Avg(cd_dep_college_count), Max(cd_dep_college_count) FROM   customer c, customer_address ca, customer_demographics WHERE  c.c_current_addr_sk = ca.ca_address_sk AND cd_demo_sk = c.c_current_cdemo_sk AND EXISTS (SELECT * FROM   store_sales, date_dim WHERE  c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) AND ( EXISTS (SELECT * FROM   web_sales, date_dim WHERE  c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) OR EXISTS (SELECT * FROM   catalog_sales, date_dim WHERE  c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) ) GROUP  BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER  BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100",sudf_5_morEveRatio,3.433,792172393,61307.73533,1,1,0
" derived from q35, udf in projection, big difference using result cache","EXPLAIN ANALYZE  SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, Count(*) cnt1, Stddev_samp(cd_dep_count), Avg(cd_dep_count), Max(cd_dep_count), sudf_5_morEveRatio_cache(cd_dep_count) cd_dep_employed_count, Count(*) cnt2, Stddev_samp(cd_dep_employed_count), Avg(cd_dep_employed_count), Max(cd_dep_employed_count), cd_dep_college_count, Count(*) cnt3, Stddev_samp(cd_dep_college_count), Avg(cd_dep_college_count), Max(cd_dep_college_count) FROM   customer c, customer_address ca, customer_demographics WHERE  c.c_current_addr_sk = ca.ca_address_sk AND cd_demo_sk = c.c_current_cdemo_sk AND EXISTS (SELECT * FROM   store_sales, date_dim WHERE  c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) AND ( EXISTS (SELECT * FROM   web_sales, date_dim WHERE  c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) OR EXISTS (SELECT * FROM   catalog_sales, date_dim WHERE  c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) ) GROUP  BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER  BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100",sudf_5_morEveRatio_cache,2.89,792172393,8172.248333,1,7.501942285,1
" derived from q35, udf in projection and predicate, big difference using result cache","EXPLAIN ANALYZE SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, Count(*) cnt1, Stddev_samp(cd_dep_count), Avg(cd_dep_count), Max(cd_dep_count), sudf_5_morEveRatio(cd_dep_count) cd_dep_employed_count, Count(*) cnt2, Stddev_samp(cd_dep_employed_count), Avg(cd_dep_employed_count), Max(cd_dep_employed_count), cd_dep_college_count, Count(*) cnt3, Stddev_samp(cd_dep_college_count), Avg(cd_dep_college_count), Max(cd_dep_college_count) FROM   customer c, customer_address ca, customer_demographics WHERE  c.c_current_addr_sk = ca.ca_address_sk AND cd_demo_sk = c.c_current_cdemo_sk AND EXISTS (SELECT * FROM   store_sales, date_dim WHERE  c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) AND ( EXISTS (SELECT * FROM   web_sales, date_dim WHERE  c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) OR EXISTS (SELECT * FROM   catalog_sales, date_dim WHERE  c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) ) AND sudf_5_morEveRatio(cd_dep_count) > 1 GROUP  BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER  BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100",sudf_5_morEveRatio,0,0,120000,1,1,0
" derived from q35, udf in projection and predicate, big difference using result cache","EXPLAIN ANALYZE  SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, Count(*) cnt1, Stddev_samp(cd_dep_count), Avg(cd_dep_count), Max(cd_dep_count), sudf_5_morEveRatio_cache(cd_dep_count) cd_dep_employed_count, Count(*) cnt2, Stddev_samp(cd_dep_employed_count), Avg(cd_dep_employed_count), Max(cd_dep_employed_count), cd_dep_college_count, Count(*) cnt3, Stddev_samp(cd_dep_college_count), Avg(cd_dep_college_count), Max(cd_dep_college_count) FROM   customer c, customer_address ca, customer_demographics WHERE  c.c_current_addr_sk = ca.ca_address_sk AND cd_demo_sk = c.c_current_cdemo_sk AND EXISTS (SELECT * FROM   store_sales, date_dim WHERE  c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) AND ( EXISTS (SELECT * FROM   web_sales, date_dim WHERE  c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) OR EXISTS (SELECT * FROM   catalog_sales, date_dim WHERE  c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) ) AND sudf_5_morEveRatio_cache(cd_dep_count) > 1 GROUP  BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER  BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100",sudf_5_morEveRatio_cache,3.196,792172970.7,8311.857667,0,14.43720583,1
" derived from q40, udf in projection and predicate, no improv using cache","EXPLAIN ANALYZE SELECT w_state , i_item_id , Sum( CASE WHEN ( Cast(d_date AS DATE) < Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_before , Sum( CASE WHEN ( Cast(d_date AS DATE) >= Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_after, sudf_stddev(cs_sales_price, i_current_price, cr_return_amt_inc_tax) as max FROM            catalog_sales LEFT OUTER JOIN catalog_returns ON              ( cs_order_number = cr_order_number AND             cs_item_sk = cr_item_sk) , warehouse , item , date_dim WHERE           i_current_price BETWEEN 0.99 AND             1.49 AND             i_item_sk = cs_item_sk AND             cs_warehouse_sk = w_warehouse_sk AND             cs_sold_date_sk = d_date_sk AND             d_date BETWEEN (Cast ('2002-06-01' AS DATE) - INTERVAL '30' day) AND             ( cast ('2002-06-01' AS date) + INTERVAL '30' day) AND sudf_stddev(cs_sales_price, i_current_price, cr_return_amt_inc_tax) > 30 GROUP BY        w_state, i_item_id, max ORDER BY        w_state, i_item_id ",sudf_stddev,3.577,61662.41,1364.043,1,1,0
" derived from q40, udf in projection and predicate, no improv using cache","EXPLAIN ANALYZE  SELECT w_state , i_item_id , Sum( CASE WHEN ( Cast(d_date AS DATE) < Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_before , Sum( CASE WHEN ( Cast(d_date AS DATE) >= Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_after, sudf_stddev_cache(cs_sales_price, i_current_price, cr_return_amt_inc_tax) as max FROM            catalog_sales LEFT OUTER JOIN catalog_returns ON              ( cs_order_number = cr_order_number AND             cs_item_sk = cr_item_sk) , warehouse , item , date_dim WHERE           i_current_price BETWEEN 0.99 AND             1.49 AND             i_item_sk = cs_item_sk AND             cs_warehouse_sk = w_warehouse_sk AND             cs_sold_date_sk = d_date_sk AND             d_date BETWEEN (Cast ('2002-06-01' AS DATE) - INTERVAL '30' day) AND             ( cast ('2002-06-01' AS date) + INTERVAL '30' day) AND sudf_stddev_cache(cs_sales_price, i_current_price, cr_return_amt_inc_tax) > 30 GROUP BY        w_state, i_item_id, max ORDER BY        w_state, i_item_id ",sudf_stddev_cache,3.573,61662.41,1375.082667,1,0.991971634,0
" derived from q40, udf in predicate, no improv using cache","EXPLAIN ANALYZE SELECT w_state , i_item_id , Sum( CASE WHEN ( Cast(d_date AS DATE) < Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_before , Sum( CASE WHEN ( Cast(d_date AS DATE) >= Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_after FROM            catalog_sales LEFT OUTER JOIN catalog_returns ON              ( cs_order_number = cr_order_number AND             cs_item_sk = cr_item_sk) , warehouse , item , date_dim WHERE           i_current_price BETWEEN 0.99 AND             1.49 AND             i_item_sk = cs_item_sk AND             cs_warehouse_sk = w_warehouse_sk AND             cs_sold_date_sk = d_date_sk AND             d_date BETWEEN (Cast ('2002-06-01' AS DATE) - INTERVAL '30' day) AND             ( cast ('2002-06-01' AS date) + INTERVAL '30' day) AND sudf_stddev(cs_sales_price, i_current_price, cr_return_amt_inc_tax) > 1 GROUP BY        w_state, i_item_id ORDER BY        w_state, i_item_id ",sudf_stddev,3.656,61648.96,1370.083,1,1,0
" derived from q40, udf in predicate, no improv using cache","EXPLAIN ANALYZE  SELECT w_state , i_item_id , Sum( CASE WHEN ( Cast(d_date AS DATE) < Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_before , Sum( CASE WHEN ( Cast(d_date AS DATE) >= Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_after FROM            catalog_sales LEFT OUTER JOIN catalog_returns ON              ( cs_order_number = cr_order_number AND             cs_item_sk = cr_item_sk) , warehouse , item , date_dim WHERE           i_current_price BETWEEN 0.99 AND             1.49 AND             i_item_sk = cs_item_sk AND             cs_warehouse_sk = w_warehouse_sk AND             cs_sold_date_sk = d_date_sk AND             d_date BETWEEN (Cast ('2002-06-01' AS DATE) - INTERVAL '30' day) AND             ( cast ('2002-06-01' AS date) + INTERVAL '30' day) AND sudf_stddev_cache(cs_sales_price, i_current_price, cr_return_amt_inc_tax) > 1 GROUP BY        w_state, i_item_id ORDER BY        w_state, i_item_id ",sudf_stddev_cache,3.599,61648.96,1380.688333,1,0.992318807,0
" derived from q75, udf in predicate, no improv using cache","EXPLAIN ANALYZE WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev(ws_sales_price, i_current_price, wr_refunded_cash) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_stddev,5.87,324443.54,6523.870667,1,1,0
" derived from q75, udf in predicate, no improv using cache","EXPLAIN ANALYZE  WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev_cache(ws_sales_price, i_current_price, wr_refunded_cash) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_stddev_cache,5.613,324443.54,6594.232667,1,0.989329767,0
" derived from q75, udf in predicate, no improv using cache","EXPLAIN ANALYZE WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev(ss_sales_price, i_current_price, sr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev(ws_sales_price, i_current_price, wr_return_amt_inc_tax) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_stddev,6.594,282859.8,8051.209333,1,1,0
" derived from q75, udf in predicate, no improv using cache","EXPLAIN ANALYZE  WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev_cache(ss_sales_price, i_current_price, sr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev_cache(ws_sales_price, i_current_price, wr_return_amt_inc_tax) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_stddev_cache,5.987,282859.8,8119.721,1,0.991562313,0
" derived from q75, udf in predicate, no improv using cache","EXPLAIN ANALYZE WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev(cs_sales_price, i_current_price, cr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev(ss_sales_price, i_current_price, sr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev(ws_sales_price, i_current_price, wr_return_amt_inc_tax) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_stddev,6.134,261466.63,9081.269,1,1,0
" derived from q75, udf in predicate, no improv using cache","EXPLAIN ANALYZE  WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev_cache(cs_sales_price, i_current_price, cr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev_cache(ss_sales_price, i_current_price, sr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev_cache(ws_sales_price, i_current_price, wr_return_amt_inc_tax) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_stddev_cache,5.933,261466.63,9197.967333,1,0.987312595,0
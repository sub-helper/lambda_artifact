type,query,func_name,udf inlinable,froid applies in actual query optimization,regression or improvement (>1 MEANS improvement),comment for froid,if lambda can optimize
" derived from procbench, udf in predicate, big difference using result cache",EXPLAIN ANALYZE SELECT * from item where sudf_8_maxretclass() is not null and i_class = sudf_8_maxretclass(),sudf_8_maxretclass,0,0,1,,N/A
" derived from q67, udf in predicate, big difference using result cache","EXPLAIN ANALYZE select from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 and sudf_8_maxretclass() is not null and i_class = sudf_8_maxretclass() order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100",sudf_8_maxretclass,0,0,1,,N/A
" derived from q45, udf in subquery predicate with null check,big difference using result cache","EXPLAIN ANALYZE SELECT ca_zip, ca_state, Sum(ws_sales_price) FROM   web_sales, customer, customer_address, date_dim, item WHERE  ws_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792' ) OR i_item_id IN (SELECT i_item_id FROM   item WHERE  i_item_sk IN ( 2, 3, 5, 7, 11, 13, 17, 19, 23, 29 ) AND sudf_8_maxretclass() is not null and i_class = sudf_8_maxretclass()) ) AND ws_sold_date_sk = d_date_sk AND d_qoy = 1 AND d_year = 2000 GROUP  BY ca_zip, ca_state ORDER  BY ca_zip, ca_state LIMIT 100",sudf_8_maxretclass,0,0,1,,N/A
" derived from q92, udf in predicate, improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_nmonthsbefore(d_Date_string, 3) between '2000-05-04' and '2030-10-05' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    sudf_nmonthsbefore(d_Date_string, 3) between '1981-08-09' and '2002-03-04' AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_nMonthsBefore,0,0,1,,N/A
" derived from q92, udf in predicate, no improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_nmonthsbefore(d_Date_string,6) between '2001-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_nMonthsBefore,0,0,1,,N/A
" derived from q92, udf in predicate and projection, improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt), sudf_nmonthsbefore(d_Date_string, 8) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_nmonthsbefore(d_Date_string, 8) between '1995-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND sudf_nmonthsbefore(d_Date_string, 8) between '1901-03-04' and '2002-03-04' AND    d_date_sk = ws_sold_date_sk) GROUP BY sudf_nmonthsbefore(d_Date_string, 8) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_nMonthsBefore,0,0,1,,N/A
" derived from q92, udf in predicate, no improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_nmonthsbefore(i_rec_start_date_string,5) between '1990-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND sudf_nmonthsbefore(i_rec_end_date_string,5) between '1980-03-04' and '2002-03-04' AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_nMonthsBefore,0,0,1,,N/A
" derived from q92, udf in predicate, improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_nmonthsbefore(i_rec_start_date_string,1) between '2000-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_nMonthsBefore,0,0,1,,N/A
" derived from q67, udf in predicate, no improv using cache","EXPLAIN ANALYZE select * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 and sudf_nmonthsbefore(s_rec_start_date_string, 4) between '1900-10-04' and '2008-03-04' group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk LIMIT 100",sudf_nMonthsBefore,0,0,1,,N/A
" derived from q67, udf in predicate, no improv using cache","EXPLAIN ANALYZE select * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 and sudf_nmonthsbefore(s_rec_start_date_string, 3) between '1900-10-04' and '2008-03-04' and sudf_nmonthsbefore(s_rec_end_date_string, 3) between '2008-03-04' and '2028-03-04' group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk LIMIT 100",sudf_nMonthsBefore,0,0,1,,N/A
" derived from sqlprocbench, udf in both predicate and projection, bigdifference using result cache","EXPLAIN ANALYZE select c_customer_sk, sudf_12_increaseInWebSpending(c_customer_sk) from customer where c_customer_sk in (select ws_bill_customer_sk from web_sales_history, date_dim where d_date_sk = ws_sold_date_sk and d_year = 2000  INTERSECT  select ws_bill_customer_sk from web_sales_history, date_dim where d_date_sk = ws_sold_date_sk and d_year = 2001 ) and sudf_12_increaseInWebSpending(c_customer_sk) > 0 limit 10",sudf_12_increaseInWebSpending,0,0,1,,N/A
" derived from q45, udf in projection, no significant difference using result cache","EXPLAIN ANALYZE select c1, c2, sudf_12_increaseInWebSpending(c_customer_sk) from (SELECT ca_zip, ca_state c1, Sum(ws_sales_price) c2, c_customer_sk FROM   web_sales, customer, customer_address, date_dim, item WHERE  ws_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792' ) OR i_item_id IN (SELECT i_item_id FROM   item WHERE  i_item_sk IN ( 2, 3, 5, 7, 11, 13, 17, 19, 23, 29 )) ) AND ws_sold_date_sk = d_date_sk AND d_qoy = 1 AND d_year = 2000 GROUP  BY ca_zip, ca_state, c_customer_sk ORDER  BY ca_zip, ca_state) t",sudf_12_increaseInWebSpending,0,0,1,,N/A
" derived from q45, udf in projection and predicate, no difference using resultcache","EXPLAIN ANALYZE select c1, c2, sudf_12_increaseInWebSpending(c_customer_sk) from (SELECT ca_zip, ca_state c1, Sum(ws_sales_price) c2, c_customer_sk FROM   web_sales, customer, customer_address, date_dim, item WHERE  ws_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792' ) OR i_item_id IN (SELECT i_item_id FROM   item WHERE  i_item_sk IN ( 2, 3, 5, 7, 11, 13, 17, 19, 23, 29 )) ) AND ws_sold_date_sk = d_date_sk AND d_qoy = 1 AND d_year = 2000 GROUP  BY ca_zip, ca_state, c_customer_sk ORDER  BY ca_zip, ca_state) t where sudf_12_increaseInWebSpending(c_customer_sk) > 0",sudf_12_increaseInWebSpending,0,0,1,,N/A
" derived from sqlprocbench, udf in projection, no difference using cache",EXPLAIN ANALYZE select s_store_sk from store where sudf_15_incomeBandOfMaxBuy(s_store_sk)='lowerMiddle' order by s_store_sk,sudf_15_incomeBandOfMaxBuy,1,0,1,,0
" derived from q65, udf in predicate, no difference using cache","EXPLAIN ANALYZE SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM   store, item, (SELECT ss_store_sk, Avg(revenue) AS ave FROM   (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sa GROUP  BY ss_store_sk) sb, (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sc WHERE  sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND sudf_15_incomeBandOfMaxBuy(s_store_sk)='lowerMiddle' ORDER  BY s_store_name, i_item_desc LIMIT 100",sudf_15_incomeBandOfMaxBuy,1,0,1,,0
" derived from q65, udf in both predicate and projection, big improv using cache","EXPLAIN ANALYZE SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand, sudf_15_incomeBandOfMaxBuy(s_store_sk) FROM   store, item, (SELECT ss_store_sk, Avg(revenue) AS ave FROM   (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sa GROUP  BY ss_store_sk) sb, (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sc WHERE  sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND sudf_15_incomeBandOfMaxBuy(s_store_sk) in ('lowerMiddle', 'low') ORDER  BY s_store_name, i_item_desc LIMIT 100",sudf_15_incomeBandOfMaxBuy,1,0,1,,1
" derived from q13, udf in projection, no difference using cache","EXPLAIN ANALYZE SELECT Avg(ss_quantity), Avg(ss_ext_sales_price), Avg(ss_ext_wholesale_cost), Sum(ss_ext_wholesale_cost), sudf_1_totalLargePurchases(ca_state, 1000, d_year, d_qoy) FROM   store_sales, store, customer_demographics, household_demographics, customer_address, date_dim WHERE  s_store_sk = ss_store_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2001 AND ( ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'U' AND cd_education_status = 'Advanced Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3 ) OR ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1 ) OR ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = 'Secondary' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1 ) ) AND ( ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'AZ', 'NE', 'IA' ) AND ss_net_profit BETWEEN 100 AND 200 ) OR ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'MS', 'CA', 'NV' ) AND ss_net_profit BETWEEN 150 AND 300 ) OR ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'GA', 'TX', 'NJ' ) AND ss_net_profit BETWEEN 50 AND 250 ) ) group by ca_state, d_year, d_qoy",sudf_1_totalLargePurchases,1,0,1,,1
" derived from q91, udf in filter predicate, significant difference using cache","EXPLAIN ANALYZE SELECT cc_call_center_id Call_Center, cc_name           Call_Center_Name, cc_manager        Manager, Sum(cr_net_loss)  Returns_Loss FROM   call_center, catalog_returns, date_dim, customer, customer_address, customer_demographics, household_demographics WHERE  cr_call_center_sk = cc_call_center_sk AND cr_returned_date_sk = d_date_sk AND cr_returning_customer_sk = c_customer_sk AND cd_demo_sk = c_current_cdemo_sk AND hd_demo_sk = c_current_hdemo_sk AND ca_address_sk = c_current_addr_sk AND d_year = 1999 AND d_moy = 12 AND ( ( cd_marital_status = 'M' AND cd_education_status = 'Unknown' ) OR ( cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree' ) ) AND hd_buy_potential LIKE 'Unknown%' AND ca_gmt_offset = -7 AND sudf_1_totalLargePurchases(ca_state, 1000, d_year, d_qoy) > 100 GROUP  BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER  BY Sum(cr_net_loss) DESC",sudf_1_totalLargePurchases,1,1,50,,1
" derived from q91, udf in filter predicate, big difference using cache","EXPLAIN ANALYZE SELECT cc_call_center_id Call_Center, cc_name           Call_Center_Name, cc_manager        Manager, Sum(cr_net_loss)  Returns_Loss FROM   call_center, catalog_returns, date_dim, customer, customer_address, customer_demographics, household_demographics WHERE  cr_call_center_sk = cc_call_center_sk AND cr_returned_date_sk = d_date_sk AND cr_returning_customer_sk = c_customer_sk AND cd_demo_sk = c_current_cdemo_sk AND hd_demo_sk = c_current_hdemo_sk AND ca_address_sk = c_current_addr_sk AND d_year = 1999 AND d_moy = 12 AND ( ( cd_marital_status = 'M' AND cd_education_status = 'Unknown' ) OR ( cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree' ) ) AND hd_buy_potential LIKE 'Unknown%' AND ca_gmt_offset = -7 AND sudf_1_totalLargePurchases(ca_state, 1000, d_year, d_qoy) is not null AND sudf_1_totalLargePurchases(ca_state, 1000, d_year, d_qoy) > 100 GROUP  BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER  BY Sum(cr_net_loss) DESC",sudf_1_totalLargePurchases,1,0,1,,1
" derived from q92, udf in predicate, small improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      sudf_dateformat(d_Date_string) between '2000-05-04' and '2030-10-05' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND sudf_dateformat(d_Date_string) is not null AND    sudf_dateformat(d_Date_string) between '1981-08-09' and '2002-03-04' AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_dateformat,0,0,1,,N/A
" derived from q92, udf in predicate, no improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND sudf_dateformat(d_Date_string) is not null AND      sudf_dateformat(d_Date_string) between '2001-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date_sk = ws_sold_date_sk) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_dateformat,0,0,1,,N/A
" derived from q92, udf in predicate and projection, small improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt), sudf_dateformat(d_Date_string) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND sudf_dateformat(d_Date_string) is not null AND      sudf_dateformat(d_Date_string) between '1995-03-04' and '2002-03-04' AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND sudf_dateformat(d_Date_string) is not null and sudf_dateformat(d_Date_string) between '1981-01-15' and '2002-03-04' AND    d_date_sk = ws_sold_date_sk) GROUP BY sudf_dateformat(d_Date_string) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_dateformat,0,0,1,,N/A
" derived from q67, udf in predicate, no improv using cache","EXPLAIN ANALYZE select * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 and sudf_dateformat(s_rec_start_date_string) is not null and sudf_dateformat(s_rec_start_date_string) between '1900-10-04' and '2008-03-04' group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk LIMIT 100",sudf_dateformat,0,0,1,,N/A
" derived from q67, udf in predicate, no improv using cache","EXPLAIN ANALYZE select * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 and sudf_dateformat(s_rec_start_date_string) is not null and sudf_dateformat(s_rec_end_date_string) is not null and sudf_dateformat(s_rec_start_date_string) between '1900-10-04' and '2008-03-04' and sudf_dateformat(s_rec_end_date_string) between '2008-03-04' and '2028-03-04' group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk LIMIT 100",sudf_dateformat,0,0,1,,N/A
" derived from sqlprocbench, udf in predicate, no improv using cache","EXPLAIN ANALYZE select ws_item_sk from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20b_GetManufactComplex(ws_item_sk) = 'oughtn st'",sudf_20b_GetManufactComplex,1,0,1,,0
" derived from sqlprocbench, udf in predicate, no improv using cache","EXPLAIN ANALYZE select ws_item_sk from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20b_GetManufactComplex(ws_item_sk) is not null and sudf_20b_GetManufactComplex(ws_item_sk) = 'oughtn st'",sudf_20b_GetManufactComplex,1,0,1,,0
" derived from sqlprocbench, udf in both predicate and projection, no improv using cache","EXPLAIN ANALYZE select ws_item_sk, sudf_20b_GetManufactComplex(ws_item_sk) from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20b_GetManufactComplex(ws_item_sk) != 'outdated item'",sudf_20b_GetManufactComplex,1,0,1,,0
" derived from sqlprocbench, udf in both predicate and projection, no improv using cache","EXPLAIN ANALYZE select ws_item_sk, sudf_20b_GetManufactComplex(ws_item_sk) from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20b_GetManufactComplex(ws_item_sk) in ('outdated item', 'oughtn st')",sudf_20b_GetManufactComplex,1,0,1,,0
" derived from sqlprocbench, udf in projection, small improvement using result cache","EXPLAIN ANALYZE select i_manufact_id, sudf_6_totalDiscount(i_manufact_id) as totalDisc from item limit 20",sudf_6_totalDiscount,1,0,1,,1
" derived from q67, udf in projection, big difference using result cache","EXPLAIN ANALYZE select from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales, discount ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id, sudf_6_totalDiscount(i_manufact_id) discount ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store , (select * from item limit 100) t where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+1 group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id, discount))dw1 limit 100) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100",sudf_6_totalDiscount,1,0,1,cannot inline udf invocation in group by clause,1
" derived from q65, udf in projection, no difference using result cache","EXPLAIN ANALYZE SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand, sudf_6_totalDiscount(i_manufact_id) FROM   store, item, (SELECT ss_store_sk, Avg(revenue) AS ave FROM   (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sa GROUP  BY ss_store_sk) sb, (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sc WHERE  sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk ORDER  BY s_store_name, i_item_desc LIMIT 100",sudf_6_totalDiscount,1,0,1,,1
" derived from q92, udf in predicate, big difference using result cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      d_date BETWEEN '2002-03-29' AND      ( Cast('2002-03-29' AS DATE) +  INTERVAL '90' day) AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date BETWEEN '2002-03-29' AND    ( cast('2002-03-29' AS date) + INTERVAL '90' day) AND    d_date_sk = ws_sold_date_sk) AND sudf_6_totalDiscount(i_manufact_id) > 100 ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_6_totalDiscount,1,0,1,,1
" derived from sqlprocbench, udf in predicate, no difference using cache","EXPLAIN ANALYZE select ws_item_sk from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20a_GetManufactSimple(ws_item_sk) = 'oughtn st'",sudf_20a_GetManufactSimple,1,0,1,,0
" derived from sqlprocbench, udf in predicate, no difference using cache","EXPLAIN ANALYZE select ws_item_sk from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20a_GetManufactSimple(ws_item_sk) is not null and sudf_20a_GetManufactSimple(ws_item_sk) = 'oughtn st'",sudf_20a_GetManufactSimple,1,0,1,,0
" derived from sqlprocbench, udf in both predicate and projection, no improv using cache","EXPLAIN ANALYZE select ws_item_sk, sudf_20a_GetManufactSimple(ws_item_sk) from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20a_GetManufactSimple(ws_item_sk) != 'outdated item'",sudf_20a_GetManufactSimple,1,0,1,,0
" derived from sqlprocbench, udf in both predicate and projection, no improv using cache","EXPLAIN ANALYZE select ws_item_sk, sudf_20a_GetManufactSimple(ws_item_sk) from (select ws_item_sk, count(*) cnt from web_sales group by ws_item_sk order by cnt limit 30 )t1 where sudf_20a_GetManufactSimple(ws_item_sk) in ('outdated item', 'oughtn st')",sudf_20a_GetManufactSimple,1,0,1,,0
" derived from q92, udf in predicate, big improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND      i_item_sk = ws_item_sk AND      d_date BETWEEN '2002-03-29' AND      ( Cast('2002-03-29' AS DATE) +  INTERVAL '90' day) AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date BETWEEN '2002-03-29' AND    ( cast('2002-03-29' AS date) + INTERVAL '90' day) AND    d_date_sk = ws_sold_date_sk AND sudf_20a_GetManufactSimple(ws_item_sk) = 'oughtn st') ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_20a_GetManufactSimple,1,0,1,,1
" derived from q75, udf in predicate, big improv using cache","EXPLAIN ANALYZE WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' AND sudf_20a_GetManufactSimple(ws_item_sk) = 'oughtn st') sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_20a_GetManufactSimple,1,0,1,,1
" derived from q40, udf in projection and predicate, no improv using result cache","EXPLAIN ANALYZE SELECT w_state , i_item_id , Sum( CASE WHEN ( Cast(d_date AS DATE) < Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_before , Sum( CASE WHEN ( Cast(d_date AS DATE) >= Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_after, sudf_max(cs_sales_price, i_current_price, cr_return_amt_inc_tax) as max FROM            catalog_sales LEFT OUTER JOIN catalog_returns ON              ( cs_order_number = cr_order_number AND             cs_item_sk = cr_item_sk) , warehouse , item , date_dim WHERE           i_current_price BETWEEN 0.99 AND             1.49 AND             i_item_sk = cs_item_sk AND             cs_warehouse_sk = w_warehouse_sk AND             cs_sold_date_sk = d_date_sk AND             d_date BETWEEN (Cast ('2002-06-01' AS DATE) - INTERVAL '30' day) AND             ( cast ('2002-06-01' AS date) + INTERVAL '30' day) AND sudf_max(cs_sales_price, i_current_price, cr_return_amt_inc_tax) > 30 GROUP BY        w_state, i_item_id, max ORDER BY        w_state, i_item_id ",sudf_max,0,0,1,,N/A
" derived from q40, udf in predicate, no improv using result cache","EXPLAIN ANALYZE SELECT w_state , i_item_id , Sum( CASE WHEN ( Cast(d_date AS DATE) < Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_before , Sum( CASE WHEN ( Cast(d_date AS DATE) >= Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_after FROM            catalog_sales LEFT OUTER JOIN catalog_returns ON              ( cs_order_number = cr_order_number AND             cs_item_sk = cr_item_sk) , warehouse , item , date_dim WHERE           i_current_price BETWEEN 0.99 AND             1.49 AND             i_item_sk = cs_item_sk AND             cs_warehouse_sk = w_warehouse_sk AND             cs_sold_date_sk = d_date_sk AND             d_date BETWEEN (Cast ('2002-06-01' AS DATE) - INTERVAL '30' day) AND             ( cast ('2002-06-01' AS date) + INTERVAL '30' day) AND sudf_max(cs_sales_price, i_current_price, cr_return_amt_inc_tax) > 1 GROUP BY        w_state, i_item_id ORDER BY        w_state, i_item_id ",sudf_max,0,0,1,,N/A
" derived from q75, udf in 1 predicate, no improv using result cache","EXPLAIN ANALYZE WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_max(ws_sales_price, i_current_price, wr_refunded_cash) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_max,0,0,1,,N/A
" derived from q75, udf in predicate, no improv using result cache","EXPLAIN ANALYZE WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' and sudf_max(ss_sales_price, i_current_price, sr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_max(ws_sales_price, i_current_price, wr_return_amt_inc_tax) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_max,0,0,1,,N/A
" derived from q75, udf in predicates, no improv using result cache","EXPLAIN ANALYZE WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' and sudf_max(cs_sales_price, i_current_price, cr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' and sudf_max(ss_sales_price, i_current_price, sr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_max(ws_sales_price, i_current_price, wr_return_amt_inc_tax) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_max,0,0,1,,N/A
" derived from sqlprocbench, udf in projection, small improvement using result cache","EXPLAIN ANALYZE select c_customer_sk, sudf_13_maxPurchaseChannel(c_customer_sk, 2000, 2020) as channel from customer limit 10",sudf_13_maxPurchaseChannel,1,0,1,,0
" derived from q45, udf in projections, no difference using result cache","EXPLAIN ANALYZE SELECT ca_zip, ca_state, Sum(ws_sales_price), sudf_13_maxPurchaseChannel(c_customer_sk, 2000,2020) FROM   web_sales, customer, customer_address, date_dim, item WHERE  ws_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792' ) OR i_item_id IN (SELECT i_item_id FROM   item WHERE  i_item_sk IN ( 2, 3, 5, 7, 11, 13, 17, 19, 23, 29 )) ) AND ws_sold_date_sk = d_date_sk AND d_qoy = 1 AND d_year = 2000 GROUP  BY ca_zip, ca_state, c_customer_sk ORDER  BY ca_zip, ca_state LIMIT 10",sudf_13_maxPurchaseChannel,1,0,1,,0
" derived from q13, udf in projection, small difference using result cache","EXPLAIN ANALYZE SELECT Avg(ss_quantity), Avg(ss_ext_sales_price), Avg(ss_ext_wholesale_cost), Sum(ss_ext_wholesale_cost), sudf_13_maxPurchaseChannel(store_sales.ss_customer_sk, 2000,2020) mp FROM   store_sales, store, customer_demographics, household_demographics, customer_address, date_dim WHERE  s_store_sk = ss_store_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2001 AND ( ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'U' AND cd_education_status = 'Advanced Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3 ) OR ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1 ) OR ( ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = 'Secondary' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1 ) ) AND ( ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'AZ', 'NE', 'IA' ) AND ss_net_profit BETWEEN 100 AND 200 ) OR ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'MS', 'CA', 'NV' ) AND ss_net_profit BETWEEN 150 AND 300 ) OR ( ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ( 'GA', 'TX', 'NJ' ) AND ss_net_profit BETWEEN 50 AND 250 ) ) GROUP BY mp",sudf_13_maxPurchaseChannel,1,0,1,cannot inline udf invocation in group by clause,1
" derived from q67, udf in projection, no improv using cache","EXPLAIN ANALYZE select from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id, i_des ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id, sudf_string_manipulation(i_item_desc, ',',',') i_des, sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id, i_des))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100",sudf_string_manipulation,0,0,1,,N/A
" derived from q65, udf in projection, no improv using cache","EXPLAIN ANALYZE SELECT s_store_name, sudf_string_manipulation(i_item_desc, ',',',') i_des,               sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM   store, item, (SELECT ss_store_sk, Avg(revenue) AS ave FROM   (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sa GROUP  BY ss_store_sk) sb, (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sc WHERE  sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk ORDER  BY s_store_name, i_item_desc LIMIT 100",sudf_string_manipulation,0,0,1,,N/A
" derived from q67, udf in projection and predicate, no improv using cache","EXPLAIN ANALYZE select from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id, i_des ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id, sudf_string_manipulation(i_item_desc, ',',',') i_des, sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1181 and 1181+11 and sudf_string_manipulation(i_item_desc, ',',',') is not null and sudf_string_manipulation(i_item_desc, ',',',') != '' group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id, i_des))dw1) dw2 where rk <= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100",sudf_string_manipulation,0,0,1,,N/A
" derived from q65, udf in projection and predicate, no improv using cache","EXPLAIN ANALYZE SELECT s_store_name, sudf_string_manipulation(i_item_desc, ',',',') i_des,               sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM   store, item, (SELECT ss_store_sk, Avg(revenue) AS ave FROM   (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sa GROUP  BY ss_store_sk) sb, (SELECT ss_store_sk, ss_item_sk, Sum(ss_sales_price) AS revenue FROM   store_sales, date_dim WHERE  ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1199 AND 1199 + 11 GROUP  BY ss_store_sk, ss_item_sk) sc WHERE  sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk and sudf_string_manipulation(i_item_desc, ',',',') is not null AND sudf_string_manipulation(i_item_desc, ',',',') != '' ORDER  BY s_store_name, i_item_desc LIMIT 100",sudf_string_manipulation,0,0,1,,N/A
" derived from q92, udf in predicate, no improv using cache","EXPLAIN ANALYZE SELECT Sum(ws_ext_discount_amt) FROM     web_sales , item , date_dim WHERE    i_manufact_id = 718 AND sudf_string_manipulation(i_item_desc, ',',',') is not null and sudf_string_manipulation(i_item_desc, ',',',') != '' AND      i_item_sk = ws_item_sk AND      d_date BETWEEN '2002-03-29' AND      ( Cast('2002-03-29' AS DATE) +  INTERVAL '90' day) AND      d_date_sk = ws_sold_date_sk AND      ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM   web_sales , date_dim WHERE  ws_item_sk = i_item_sk AND    d_date BETWEEN '2002-03-29' AND    ( cast('2002-03-29' AS date) + INTERVAL '90' day) AND    d_date_sk = ws_sold_date_sk ) ORDER BY sum(ws_ext_discount_amt) LIMIT 100",sudf_string_manipulation,0,0,1,,N/A
" derived from sqlprocbench, udf in predicate, big difference using result cache","EXPLAIN ANALYZE select * from (select * from store limit 10) as t where sudf_7_profitableManager(t.s_manager, 2001)<=0",sudf_7_profitableManager,0,0,1,,N/A
" derived from q34, udf in predicate, big difference using result cache","EXPLAIN ANALYZE SELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM   (SELECT ss_ticket_number, ss_customer_sk, Count(*) cnt FROM   store_sales, date_dim, store, household_demographics WHERE  store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_store_sk = store.s_store_sk AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND ( date_dim.d_dom BETWEEN 1 AND 3 OR date_dim.d_dom BETWEEN 25 AND 28 ) AND ( household_demographics.hd_buy_potential = '>10000' OR household_demographics.hd_buy_potential = 'unknown' ) AND household_demographics.hd_vehicle_count > 0 AND ( CASE WHEN household_demographics.hd_vehicle_count > 0 THEN household_demographics.hd_dep_count / household_demographics.hd_vehicle_count ELSE NULL END ) > 1.2 AND date_dim.d_year IN ( 1999, 1999 + 1, 1999 + 2 ) AND store.s_county IN ( 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County' , 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County' ) And sudf_7_profitableManager(store.s_manager, 2001)<=0 GROUP  BY ss_ticket_number, ss_customer_sk) dn, customer WHERE  ss_customer_sk = c_customer_sk AND cnt BETWEEN 15 AND 20 ORDER  BY c_last_name, c_first_name, c_salutation, c_preferred_cust_flag DESC",sudf_7_profitableManager,0,0,1,,N/A
" derived from q34, udf in predicate, big difference using result cache","EXPLAIN ANALYZE SELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM   (SELECT ss_ticket_number, ss_customer_sk, Count(*) cnt FROM   store_sales, date_dim, store, household_demographics WHERE  store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_store_sk = store.s_store_sk AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk AND ( date_dim.d_dom BETWEEN 1 AND 3 OR date_dim.d_dom BETWEEN 25 AND 28 ) AND ( household_demographics.hd_buy_potential = '>10000' OR household_demographics.hd_buy_potential = 'unknown' ) AND household_demographics.hd_vehicle_count > 0 AND ( CASE WHEN household_demographics.hd_vehicle_count > 0 THEN household_demographics.hd_dep_count / household_demographics.hd_vehicle_count ELSE NULL END ) > 1.2 AND date_dim.d_year IN ( 1999, 1999 + 1, 1999 + 2 ) AND store.s_county IN ( 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County' , 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County' ) And sudf_7_profitableManager(store.s_manager, date_dim.d_year)<=0 GROUP  BY ss_ticket_number, ss_customer_sk) dn, customer WHERE  ss_customer_sk = c_customer_sk AND cnt BETWEEN 15 AND 20 ORDER  BY c_last_name, c_first_name, c_salutation, c_preferred_cust_flag DESC",sudf_7_profitableManager,0,0,1,,N/A
" derived from sqlprocbench, udf in projection, no difference","EXPLAIN ANALYZE select t.depCount, sudf_5_morEveRatio(t.depCount) from (select distinct cd_dep_count as depCount from customer_demographics)t",sudf_5_morEveRatio,1,0,1,,0
" derived from q35, udf in projection, big difference using result cache","EXPLAIN ANALYZE SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, Count(*) cnt1, Stddev_samp(cd_dep_count), Avg(cd_dep_count), Max(cd_dep_count), sudf_5_morEveRatio(cd_dep_count) cd_dep_employed_count, Count(*) cnt2, Stddev_samp(cd_dep_employed_count), Avg(cd_dep_employed_count), Max(cd_dep_employed_count), cd_dep_college_count, Count(*) cnt3, Stddev_samp(cd_dep_college_count), Avg(cd_dep_college_count), Max(cd_dep_college_count) FROM   customer c, customer_address ca, customer_demographics WHERE  c.c_current_addr_sk = ca.ca_address_sk AND cd_demo_sk = c.c_current_cdemo_sk AND EXISTS (SELECT * FROM   store_sales, date_dim WHERE  c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) AND ( EXISTS (SELECT * FROM   web_sales, date_dim WHERE  c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) OR EXISTS (SELECT * FROM   catalog_sales, date_dim WHERE  c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) ) GROUP  BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER  BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100",sudf_5_morEveRatio,1,0,1,,1
" derived from q35, udf in projection and predicate, big difference using result cache","EXPLAIN ANALYZE SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, Count(*) cnt1, Stddev_samp(cd_dep_count), Avg(cd_dep_count), Max(cd_dep_count), sudf_5_morEveRatio(cd_dep_count) cd_dep_employed_count, Count(*) cnt2, Stddev_samp(cd_dep_employed_count), Avg(cd_dep_employed_count), Max(cd_dep_employed_count), cd_dep_college_count, Count(*) cnt3, Stddev_samp(cd_dep_college_count), Avg(cd_dep_college_count), Max(cd_dep_college_count) FROM   customer c, customer_address ca, customer_demographics WHERE  c.c_current_addr_sk = ca.ca_address_sk AND cd_demo_sk = c.c_current_cdemo_sk AND EXISTS (SELECT * FROM   store_sales, date_dim WHERE  c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) AND ( EXISTS (SELECT * FROM   web_sales, date_dim WHERE  c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) OR EXISTS (SELECT * FROM   catalog_sales, date_dim WHERE  c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) ) AND sudf_5_morEveRatio(cd_dep_count) > 1 GROUP  BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER  BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100",sudf_5_morEveRatio,1,0,1,,1
" derived from q40, udf in projection and predicate, no improv using cache","EXPLAIN ANALYZE SELECT w_state , i_item_id , Sum( CASE WHEN ( Cast(d_date AS DATE) < Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_before , Sum( CASE WHEN ( Cast(d_date AS DATE) >= Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_after, sudf_stddev(cs_sales_price, i_current_price, cr_return_amt_inc_tax) as max FROM            catalog_sales LEFT OUTER JOIN catalog_returns ON              ( cs_order_number = cr_order_number AND             cs_item_sk = cr_item_sk) , warehouse , item , date_dim WHERE           i_current_price BETWEEN 0.99 AND             1.49 AND             i_item_sk = cs_item_sk AND             cs_warehouse_sk = w_warehouse_sk AND             cs_sold_date_sk = d_date_sk AND             d_date BETWEEN (Cast ('2002-06-01' AS DATE) - INTERVAL '30' day) AND             ( cast ('2002-06-01' AS date) + INTERVAL '30' day) AND sudf_stddev(cs_sales_price, i_current_price, cr_return_amt_inc_tax) > 30 GROUP BY        w_state, i_item_id, max ORDER BY        w_state, i_item_id ",sudf_stddev,0,0,1,,N/A
" derived from q40, udf in predicate, no improv using cache","EXPLAIN ANALYZE SELECT w_state , i_item_id , Sum( CASE WHEN ( Cast(d_date AS DATE) < Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_before , Sum( CASE WHEN ( Cast(d_date AS DATE) >= Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_after FROM            catalog_sales LEFT OUTER JOIN catalog_returns ON              ( cs_order_number = cr_order_number AND             cs_item_sk = cr_item_sk) , warehouse , item , date_dim WHERE           i_current_price BETWEEN 0.99 AND             1.49 AND             i_item_sk = cs_item_sk AND             cs_warehouse_sk = w_warehouse_sk AND             cs_sold_date_sk = d_date_sk AND             d_date BETWEEN (Cast ('2002-06-01' AS DATE) - INTERVAL '30' day) AND             ( cast ('2002-06-01' AS date) + INTERVAL '30' day) AND sudf_stddev(cs_sales_price, i_current_price, cr_return_amt_inc_tax) > 1 GROUP BY        w_state, i_item_id ORDER BY        w_state, i_item_id ",sudf_stddev,0,0,1,,N/A
" derived from q75, udf in predicate, no improv using cache","EXPLAIN ANALYZE WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev(ws_sales_price, i_current_price, wr_refunded_cash) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_stddev,0,0,1,,N/A
" derived from q75, udf in predicate, no improv using cache","EXPLAIN ANALYZE WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev(ss_sales_price, i_current_price, sr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev(ws_sales_price, i_current_price, wr_return_amt_inc_tax) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_stddev,0,0,1,,N/A
" derived from q75, udf in predicate, no improv using cache","EXPLAIN ANALYZE WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, Sum(sales_cnt) AS sales_cnt, Sum(sales_amt) AS sales_amt FROM   (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0)        AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM   catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON ( cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev(cs_sales_price, i_current_price, cr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0)     AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM   store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON ( ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev(ss_sales_price, i_current_price, sr_refunded_cash) > i_current_price UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0)     AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM   web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON ( ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk ) WHERE  i_category = 'Men' and sudf_stddev(ws_sales_price, i_current_price, wr_return_amt_inc_tax) > i_current_price) sales_detail GROUP  BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT prev_yr.d_year                        AS prev_year, curr_yr.d_year                        AS year1, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt                     AS prev_yr_cnt, curr_yr.sales_cnt                     AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM   all_sales curr_yr, all_sales prev_yr WHERE  curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND Cast(curr_yr.sales_cnt AS DECIMAL(17, 2)) / Cast(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER  BY sales_cnt_diff LIMIT 100",sudf_stddev,0,0,1,,N/A
,count,,26,1,,,13